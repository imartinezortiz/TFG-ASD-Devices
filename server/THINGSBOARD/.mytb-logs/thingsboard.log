2024-01-25 16:54:43,902 [background-preinit] INFO  o.h.validator.internal.util.Version - HV000001: Hibernate Validator 6.0.20.Final
2024-01-25 16:54:44,018 [main] INFO  o.t.s.ThingsboardServerApplication - Starting ThingsboardServerApplication v3.6.2 using Java 11.0.20 on 138a9a50b9a6 with PID 22 (/usr/share/thingsboard/bin/thingsboard.jar started by thingsboard in /)
2024-01-25 16:54:44,024 [main] INFO  o.t.s.ThingsboardServerApplication - No active profile set, falling back to 1 default profile: "default"
2024-01-25 16:54:49,811 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2024-01-25 16:54:49,812 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2024-01-25 16:54:50,235 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 380 ms. Found 1 JPA repository interfaces.
2024-01-25 16:54:50,239 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2024-01-25 16:54:50,239 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2024-01-25 16:54:50,796 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 556 ms. Found 54 JPA repository interfaces.
2024-01-25 16:54:50,799 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2024-01-25 16:54:50,800 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2024-01-25 16:54:50,824 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 23 ms. Found 1 JPA repository interfaces.
2024-01-25 16:54:50,825 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2024-01-25 16:54:50,827 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2024-01-25 16:54:50,857 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 28 ms. Found 1 JPA repository interfaces.
2024-01-25 16:54:51,825 [main] INFO  o.s.i.c.DefaultConfiguringBeanFactoryPostProcessor - No bean named 'errorChannel' has been explicitly defined. Therefore, a default PublishSubscribeChannel will be created.
2024-01-25 16:54:51,867 [main] INFO  o.s.i.c.DefaultConfiguringBeanFactoryPostProcessor - No bean named 'integrationHeaderChannelRegistry' has been explicitly defined. Therefore, a default DefaultHeaderChannelRegistry will be created.
2024-01-25 16:54:53,595 [main] INFO  o.t.s.q.d.DefaultTbServiceInfoProvider - Current Service ID: 138a9a50b9a6
2024-01-25 16:54:55,460 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2024-01-25 16:54:55,674 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 5.6.15.Final
2024-01-25 16:54:56,071 [main] INFO  o.h.annotations.common.Version - HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2024-01-25 16:54:56,282 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2024-01-25 16:54:56,663 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2024-01-25 16:54:56,705 [main] INFO  org.hibernate.dialect.Dialect - HHH000400: Using dialect: org.thingsboard.server.dao.ThingsboardPostgreSQLDialect
2024-01-25 16:54:59,911 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2024-01-25 16:54:59,962 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2024-01-25 16:55:10,779 [main] INFO  o.t.s.c.t.c.ssl.SslCredentialsConfig - HTTP Server SSL Credentials: Initializing SSL credentials.
2024-01-25 16:55:11,000 [main] INFO  o.t.server.common.data.ResourceUtils - Reading resource data from file /cert/thingsboard.asd.pem
2024-01-25 16:55:11,110 [main] INFO  o.t.server.common.data.ResourceUtils - Reading resource data from file /cert/thingsboard.asd-key.pem
2024-01-25 16:55:11,882 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 9090 (https)
2024-01-25 16:55:11,938 [main] INFO  o.a.coyote.http11.Http11NioProtocol - The ["https-jsse-nio-0.0.0.0-9090"] connector has been configured to support negotiation to [h2] via ALPN
2024-01-25 16:55:11,940 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["https-jsse-nio-0.0.0.0-9090"]
2024-01-25 16:55:11,948 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2024-01-25 16:55:11,949 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.73]
2024-01-25 16:55:12,105 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2024-01-25 16:55:12,106 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 27837 ms
2024-01-25 16:55:12,490 [main] INFO  o.t.s.d.a.CachedAttributesService - Going to use directExecutor for the local cache type caffeine
2024-01-25 16:55:14,794 [main] INFO  o.t.s.s.a.DefaultTbApiUsageStateService - Starting api usage service.
2024-01-25 16:55:14,800 [main] INFO  o.t.s.s.a.DefaultTbApiUsageStateService - Started api usage service.
2024-01-25 16:55:17,431 [main] INFO  o.t.s.s.edge.rpc.EdgeGrpcService - Initializing Edge RPC service!
2024-01-25 16:55:17,937 [main] INFO  o.t.s.s.edge.rpc.EdgeGrpcService - Going to start Edge RPC server using port: 7070
2024-01-25 16:55:18,170 [main] INFO  o.t.s.s.edge.rpc.EdgeGrpcService - Edge RPC service initialized!
2024-01-25 16:55:20,649 [main] INFO  o.t.s.c.t.c.ssl.SslCredentialsConfig - LWM2M Server DTLS Credentials: Skipping initialization of disabled SSL credentials.
2024-01-25 16:55:20,659 [main] INFO  o.t.s.c.t.c.ssl.SslCredentialsConfig - LWM2M Trust Credentials: Skipping initialization of disabled SSL credentials.
2024-01-25 16:55:20,686 [main] INFO  o.t.s.c.t.c.ssl.SslCredentialsConfig - LWM2M Bootstrap DTLS Credentials: Skipping initialization of disabled SSL credentials.
2024-01-25 16:55:20,838 [main] INFO  o.t.s.q.e.EnvironmentLogService - ThingsBoard server environment: zookeeper.version=3.8.1-74db005175a4ec545697012f9069cb9dcc8cdda7, built on 2023-01-25 16:31 UTC
2024-01-25 16:55:20,839 [main] INFO  o.t.s.q.e.EnvironmentLogService - ThingsBoard server environment: host.name=138a9a50b9a6
2024-01-25 16:55:20,843 [main] INFO  o.t.s.q.e.EnvironmentLogService - ThingsBoard server environment: java.version=11.0.20
2024-01-25 16:55:20,844 [main] INFO  o.t.s.q.e.EnvironmentLogService - ThingsBoard server environment: java.vendor=Debian
2024-01-25 16:55:20,848 [main] INFO  o.t.s.q.e.EnvironmentLogService - ThingsBoard server environment: java.home=/usr/lib/jvm/java-11-openjdk-amd64
2024-01-25 16:55:20,849 [main] INFO  o.t.s.q.e.EnvironmentLogService - ThingsBoard server environment: java.class.path=/usr/share/thingsboard/bin/thingsboard.jar
2024-01-25 16:55:20,850 [main] INFO  o.t.s.q.e.EnvironmentLogService - ThingsBoard server environment: java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2024-01-25 16:55:20,850 [main] INFO  o.t.s.q.e.EnvironmentLogService - ThingsBoard server environment: java.io.tmpdir=/tmp
2024-01-25 16:55:20,852 [main] INFO  o.t.s.q.e.EnvironmentLogService - ThingsBoard server environment: java.compiler=<NA>
2024-01-25 16:55:20,855 [main] INFO  o.t.s.q.e.EnvironmentLogService - ThingsBoard server environment: os.name=Linux
2024-01-25 16:55:20,856 [main] INFO  o.t.s.q.e.EnvironmentLogService - ThingsBoard server environment: os.arch=amd64
2024-01-25 16:55:20,857 [main] INFO  o.t.s.q.e.EnvironmentLogService - ThingsBoard server environment: os.version=5.15.133.1-microsoft-standard-WSL2
2024-01-25 16:55:20,861 [main] INFO  o.t.s.q.e.EnvironmentLogService - ThingsBoard server environment: user.name=thingsboard
2024-01-25 16:55:20,868 [main] INFO  o.t.s.q.e.EnvironmentLogService - ThingsBoard server environment: user.home=/home/thingsboard
2024-01-25 16:55:20,869 [main] INFO  o.t.s.q.e.EnvironmentLogService - ThingsBoard server environment: user.dir=/
2024-01-25 16:55:20,870 [main] INFO  o.t.s.q.e.EnvironmentLogService - ThingsBoard server environment: os.memory.free=252MB
2024-01-25 16:55:20,871 [main] INFO  o.t.s.q.e.EnvironmentLogService - ThingsBoard server environment: os.memory.max=3970MB
2024-01-25 16:55:20,871 [main] INFO  o.t.s.q.e.EnvironmentLogService - ThingsBoard server environment: os.memory.total=632MB
2024-01-25 16:55:20,957 [main] INFO  d.n.internal.NashornDetection - Delight-nashorn-sandbox detected that JDK Nashorn is present and standalone Nashorn is absent, and will use JDK Nashorn
2024-01-25 16:55:22,892 [main] INFO  o.t.s.a.service.DefaultActorService - Initializing actor system.
2024-01-25 16:55:22,923 [main] INFO  o.t.s.a.service.DefaultActorService - Actor system initialized.
2024-01-25 16:55:23,061 [main] INFO  o.t.s.s.e.EdgeEventSourcingListener - EdgeEventSourcingListener initiated
2024-01-25 16:55:23,262 [main] INFO  o.t.s.c.SystemInfoController - System build info: {"version":"3.6.2","artifact":"application","name":"ThingsBoard Server Application"}
2024-01-25 16:55:23,706 [main] INFO  o.t.s.c.adaptor.JsonConverterConfig - JSON max string value length = 0
2024-01-25 16:55:23,708 [main] INFO  o.t.s.c.adaptor.JsonConverterConfig - JSON type cast enabled = true
2024-01-25 16:55:23,843 [main] INFO  o.t.s.c.t.c.ssl.SslCredentialsConfig - MQTT SSL Credentials: Initializing SSL credentials.
2024-01-25 16:55:23,847 [main] INFO  o.t.server.common.data.ResourceUtils - Reading resource data from file /cert/thingsboard.asd.pem
2024-01-25 16:55:23,857 [main] INFO  o.t.server.common.data.ResourceUtils - Reading resource data from file /cert/thingsboard.asd-key.pem
2024-01-25 16:55:24,015 [main] INFO  o.t.s.t.mqtt.MqttTransportService - Setting resource leak detector level to DISABLED
2024-01-25 16:55:24,016 [main] INFO  o.t.s.t.mqtt.MqttTransportService - Starting MQTT transport...
2024-01-25 16:55:24,148 [main] INFO  o.t.s.t.mqtt.MqttTransportService - Mqtt transport started!
2024-01-25 16:55:24,244 [main] INFO  o.e.c.elements.config.Configuration - defaults added COAP.
2024-01-25 16:55:24,278 [main] INFO  o.e.c.elements.config.Configuration - defaults added UDP.
2024-01-25 16:55:24,283 [main] INFO  o.e.c.c.network.RandomTokenGenerator - using tokens of 8 bytes in length
2024-01-25 16:55:24,343 [main] INFO  org.eclipse.californium.ban - Started.
2024-01-25 16:55:24,349 [main] INFO  o.e.c.core.network.CoapEndpoint - coap CoapEndpoint uses udp context
2024-01-25 16:55:24,394 [main] INFO  o.e.c.elements.config.Configuration - defaults added SYS.
2024-01-25 16:55:24,395 [main] INFO  o.e.c.c.network.stack.BlockwiseLayer - coap BlockwiseLayer uses MAX_MESSAGE_SIZE=1024, PREFERRED_BLOCK_SIZE=1024, BLOCKWISE_STATUS_LIFETIME=300000, MAX_RESOURCE_BODY_SIZE=268435456, BLOCKWISE_STRICT_BLOCK2_OPTION=true
2024-01-25 16:55:24,429 [main] INFO  o.e.californium.core.CoapServer - Starting server
2024-01-25 16:55:24,457 [main] INFO  o.e.c.elements.UDPConnector - UDPConnector starts up 1 sender threads and 1 receiver threads
2024-01-25 16:55:24,475 [main] INFO  o.e.c.elements.UDPConnector - UDPConnector listening on 0.0.0.0/0.0.0.0:5683, recv buf = 106496, send buf = 106496, recv packet size = 2048
2024-01-25 16:55:24,487 [main] INFO  o.e.c.core.network.CoapEndpoint - coap Started endpoint at coap://0.0.0.0:5683
2024-01-25 16:55:24,585 [main] INFO  o.t.s.t.coap.CoapTransportService - Starting CoAP transport...
2024-01-25 16:55:24,602 [main] INFO  o.t.s.t.coap.CoapTransportService - CoAP transport started!
2024-01-25 16:55:25,112 [main] INFO  o.t.s.t.l.b.LwM2MTransportBootstrapService - Starting LwM2M transport bootstrap server...
2024-01-25 16:55:25,375 [main] INFO  o.e.c.elements.config.Configuration - defaults added DTLS.
2024-01-25 16:55:25,376 [main] INFO  o.t.s.t.l.b.LwM2MTransportBootstrapService - Unable to load X509 files for BootStrap Server
2024-01-25 16:55:25,541 [main] WARN  o.e.l.s.c.b.LeshanBootstrapServerBuilder - configStore is set but you also provide a custom SessionManager so this store will not be used
2024-01-25 16:55:25,656 [main] INFO  o.e.c.c.network.RandomTokenGenerator - using tokens of 8 bytes in length
2024-01-25 16:55:25,658 [main] INFO  o.e.c.core.network.CoapEndpoint - [LWM2M BS Server-coap://] CoapEndpoint uses udp context
2024-01-25 16:55:25,659 [main] INFO  o.e.c.c.network.stack.BlockwiseLayer - [LWM2M BS Server-coap://] BlockwiseLayer uses MAX_MESSAGE_SIZE=1024, PREFERRED_BLOCK_SIZE=1024, BLOCKWISE_STATUS_LIFETIME=300000, MAX_RESOURCE_BODY_SIZE=268435456, BLOCKWISE_STRICT_BLOCK2_OPTION=true
2024-01-25 16:55:25,687 [main] INFO  o.e.c.s.dtls.InMemoryConnectionStore - Created new InMemoryConnectionStore [capacity: 150000, connection expiration threshold: 1800s]
2024-01-25 16:55:25,696 [main] INFO  o.e.c.c.network.RandomTokenGenerator - using tokens of 8 bytes in length
2024-01-25 16:55:25,697 [main] INFO  o.e.c.core.network.CoapEndpoint - [LWM2M BS Server-coaps://] CoapEndpoint uses lwm2m correlation
2024-01-25 16:55:25,697 [main] INFO  o.e.c.c.network.stack.BlockwiseLayer - [LWM2M BS Server-coaps://] BlockwiseLayer uses MAX_MESSAGE_SIZE=1024, PREFERRED_BLOCK_SIZE=1024, BLOCKWISE_STATUS_LIFETIME=300000, MAX_RESOURCE_BODY_SIZE=268435456, BLOCKWISE_STRICT_BLOCK2_OPTION=true
2024-01-25 16:55:25,712 [main] INFO  o.e.californium.core.CoapServer - Starting server
2024-01-25 16:55:25,721 [main] INFO  o.e.c.elements.UDPConnector - UDPConnector starts up 2 sender threads and 2 receiver threads
2024-01-25 16:55:25,723 [main] INFO  o.e.c.elements.UDPConnector - UDPConnector listening on 0.0.0.0/0.0.0.0:5687, recv buf = 106496, send buf = 106496, recv packet size = 2048
2024-01-25 16:55:25,725 [main] INFO  o.e.c.core.network.CoapEndpoint - [LWM2M BS Server-coap://] Started endpoint at coap://0.0.0.0:5687
2024-01-25 16:55:25,728 [main] INFO  o.e.c.scandium.DTLSConnector - multiple network interfaces, using smallest MTU [IPv4 1500, IPv6 1280]
2024-01-25 16:55:25,732 [main] INFO  o.e.c.scandium.DTLSConnector - DTLSConnector listening on 0.0.0.0/0.0.0.0:5688, recv buf = 106496, send buf = 106496, recv packet size = 16490, MTU = IPv4 1500 / IPv6 1280
2024-01-25 16:55:25,732 [DTLS-Receiver-0-0.0.0.0/0.0.0.0:5688] INFO  o.e.c.scandium.DTLSConnector - Starting worker thread [DTLS-Receiver-0-0.0.0.0/0.0.0.0:5688]
2024-01-25 16:55:25,734 [main] INFO  o.e.c.core.network.CoapEndpoint - [LWM2M BS Server-coaps://] Started endpoint at coaps://0.0.0.0:5688
2024-01-25 16:55:25,735 [main] INFO  o.e.l.s.c.b.LeshanBootstrapServer - Bootstrap server started at coap://0.0.0.0/0.0.0.0:5687 coaps://0.0.0.0/0.0.0.0:5688
2024-01-25 16:55:25,736 [main] INFO  o.t.s.t.l.b.LwM2MTransportBootstrapService - Started LwM2M transport bootstrap server.
2024-01-25 16:55:25,880 [main] INFO  o.t.s.t.s.s.SnmpTransportService - SNMP transport service initialized
2024-01-25 16:55:26,971 [main] INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint(s) beneath base path '/actuator'
2024-01-25 16:55:27,768 [main] INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure Or [Ant [pattern='/*.js'], Ant [pattern='/*.css'], Ant [pattern='/*.ico'], Ant [pattern='/assets/**'], Ant [pattern='/static/**']] with [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@67807d9a, org.springframework.security.web.header.HeaderWriterFilter@4fcbb165, org.springframework.security.web.csrf.CsrfFilter@41c77861, org.springframework.security.web.authentication.logout.LogoutFilter@6a4484e6, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@6317f6d, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@27523869, org.springframework.security.web.access.ExceptionTranslationFilter@308034aa, org.springframework.security.web.access.intercept.AuthorizationFilter@472cf6af]
2024-01-25 16:55:28,078 [main] INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@6d386dff, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@1cf8d43b, org.springframework.security.web.context.SecurityContextPersistenceFilter@4289feba, org.springframework.security.web.header.HeaderWriterFilter@24fe3184, org.springframework.web.filter.CorsFilter@1dcfbad1, org.springframework.security.web.authentication.logout.LogoutFilter@79052209, org.springframework.security.oauth2.client.web.OAuth2AuthorizationRequestRedirectFilter@232e1f66, org.springframework.security.oauth2.client.web.OAuth2LoginAuthenticationFilter@431298ef, org.thingsboard.server.service.security.auth.rest.RestLoginProcessingFilter@2fedfff1, org.thingsboard.server.service.security.auth.rest.RestPublicLoginProcessingFilter@34db5935, org.thingsboard.server.service.security.auth.jwt.JwtTokenAuthenticationProcessingFilter@4ffe2ded, org.thingsboard.server.service.security.auth.jwt.RefreshTokenProcessingFilter@1666e021, org.thingsboard.server.config.RateLimitProcessingFilter@70ba01be, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@58f28c5e, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@20ecbeda, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@187c011d, org.springframework.security.web.session.SessionManagementFilter@63cde372, org.springframework.security.web.access.ExceptionTranslationFilter@219505d9, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@3ffa007c]
2024-01-25 16:55:28,637 [main] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page: class path resource [public/index.html]
2024-01-25 16:55:29,624 [main] INFO  o.s.i.endpoint.EventDrivenConsumer - Adding {logging-channel-adapter:_org.springframework.integration.errorLogger} as a subscriber to the 'errorChannel' channel
2024-01-25 16:55:29,626 [main] INFO  o.s.i.c.PublishSubscribeChannel - Channel 'application.errorChannel' has 1 subscriber(s).
2024-01-25 16:55:29,628 [main] INFO  o.s.i.endpoint.EventDrivenConsumer - started bean '_org.springframework.integration.errorLogger'
2024-01-25 16:55:29,629 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["https-jsse-nio-0.0.0.0-9090"]
2024-01-25 16:55:29,698 [main] INFO  o.a.t.u.net.NioEndpoint.certificate - Connector [https-jsse-nio-0.0.0.0-9090], TLS virtual host [_default_], certificate type [UNDEFINED] configured from [/home/thingsboard/.keystore] using alias [server] and with trust store [null]
2024-01-25 16:55:29,726 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 9090 (https) with context path ''
2024-01-25 16:55:38,733 [TB-Scheduling-2] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [0]
2024-01-25 16:55:38,742 [main] INFO  o.t.s.ThingsboardServerApplication - Started ThingsboardServerApplication in 56.038 seconds (JVM running for 57.953)
2024-01-25 16:55:38,849 [main] INFO  o.t.s.q.d.HashPartitionService - [138a9a50b9a6] Found common server: [[TB_CORE, TB_RULE_ENGINE, TB_TRANSPORT, JS_EXECUTOR, TB_VC_EXECUTOR]]
2024-01-25 16:55:38,868 [main] INFO  o.t.s.q.d.HashPartitionService - [QK(HighPriority,TB_RULE_ENGINE,system)] NEW PARTITIONS: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
2024-01-25 16:55:38,890 [main] INFO  o.t.s.q.d.HashPartitionService - [QK(SequentialByOriginator,TB_RULE_ENGINE,system)] NEW PARTITIONS: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
2024-01-25 16:55:38,891 [main] INFO  o.t.s.q.d.HashPartitionService - [QK(Main,TB_VC_EXECUTOR,system)] NEW PARTITIONS: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
2024-01-25 16:55:38,893 [main] INFO  o.t.s.q.d.HashPartitionService - [QK(Main,TB_RULE_ENGINE,system)] NEW PARTITIONS: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
2024-01-25 16:55:38,894 [main] INFO  o.t.s.q.d.HashPartitionService - [QK(Main,TB_CORE,system)] NEW PARTITIONS: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
2024-01-25 16:55:38,910 [main] INFO  o.t.s.a.service.DefaultActorService - Received partition change event.
2024-01-25 16:55:38,915 [main] INFO  o.t.s.a.service.DefaultActorService - Received partition change event.
2024-01-25 16:55:38,925 [main] INFO  o.t.s.q.d.TbApplicationEventListener - Application event ignored due to invalid sequence number (2 > 2). Event: PartitionChangeEvent(super=TbApplicationEvent(sequenceNumber=2), serviceType=TB_RULE_ENGINE, partitionsMap={QK(HighPriority,TB_RULE_ENGINE,system)=[TopicPartitionInfo(topic=tb_rule_engine.hp, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[9], fullTopicName=tb_rule_engine.hp.9, myPartition=true), TopicPartitionInfo(topic=tb_rule_engine.hp, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[7], fullTopicName=tb_rule_engine.hp.7, myPartition=true), TopicPartitionInfo(topic=tb_rule_engine.hp, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[8], fullTopicName=tb_rule_engine.hp.8, myPartition=true), TopicPartitionInfo(topic=tb_rule_engine.hp, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[5], fullTopicName=tb_rule_engine.hp.5, myPartition=true), TopicPartitionInfo(topic=tb_rule_engine.hp, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[6], fullTopicName=tb_rule_engine.hp.6, myPartition=true), TopicPartitionInfo(topic=tb_rule_engine.hp, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[3], fullTopicName=tb_rule_engine.hp.3, myPartition=true), TopicPartitionInfo(topic=tb_rule_engine.hp, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[4], fullTopicName=tb_rule_engine.hp.4, myPartition=true), TopicPartitionInfo(topic=tb_rule_engine.hp, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[1], fullTopicName=tb_rule_engine.hp.1, myPartition=true), TopicPartitionInfo(topic=tb_rule_engine.hp, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[2], fullTopicName=tb_rule_engine.hp.2, myPartition=true), TopicPartitionInfo(topic=tb_rule_engine.hp, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[0], fullTopicName=tb_rule_engine.hp.0, myPartition=true)], QK(SequentialByOriginator,TB_RULE_ENGINE,system)=[TopicPartitionInfo(topic=tb_rule_engine.sq, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[9], fullTopicName=tb_rule_engine.sq.9, myPartition=true), TopicPartitionInfo(topic=tb_rule_engine.sq, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[8], fullTopicName=tb_rule_engine.sq.8, myPartition=true), TopicPartitionInfo(topic=tb_rule_engine.sq, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[7], fullTopicName=tb_rule_engine.sq.7, myPartition=true), TopicPartitionInfo(topic=tb_rule_engine.sq, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[2], fullTopicName=tb_rule_engine.sq.2, myPartition=true), TopicPartitionInfo(topic=tb_rule_engine.sq, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[1], fullTopicName=tb_rule_engine.sq.1, myPartition=true), TopicPartitionInfo(topic=tb_rule_engine.sq, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[0], fullTopicName=tb_rule_engine.sq.0, myPartition=true), TopicPartitionInfo(topic=tb_rule_engine.sq, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[6], fullTopicName=tb_rule_engine.sq.6, myPartition=true), TopicPartitionInfo(topic=tb_rule_engine.sq, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[5], fullTopicName=tb_rule_engine.sq.5, myPartition=true), TopicPartitionInfo(topic=tb_rule_engine.sq, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[4], fullTopicName=tb_rule_engine.sq.4, myPartition=true), TopicPartitionInfo(topic=tb_rule_engine.sq, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[3], fullTopicName=tb_rule_engine.sq.3, myPartition=true)], QK(Main,TB_RULE_ENGINE,system)=[TopicPartitionInfo(topic=tb_rule_engine.main, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[8], fullTopicName=tb_rule_engine.main.8, myPartition=true), TopicPartitionInfo(topic=tb_rule_engine.main, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[9], fullTopicName=tb_rule_engine.main.9, myPartition=true), TopicPartitionInfo(topic=tb_rule_engine.main, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[6], fullTopicName=tb_rule_engine.main.6, myPartition=true), TopicPartitionInfo(topic=tb_rule_engine.main, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[7], fullTopicName=tb_rule_engine.main.7, myPartition=true), TopicPartitionInfo(topic=tb_rule_engine.main, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[4], fullTopicName=tb_rule_engine.main.4, myPartition=true), TopicPartitionInfo(topic=tb_rule_engine.main, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[5], fullTopicName=tb_rule_engine.main.5, myPartition=true), TopicPartitionInfo(topic=tb_rule_engine.main, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[2], fullTopicName=tb_rule_engine.main.2, myPartition=true), TopicPartitionInfo(topic=tb_rule_engine.main, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[3], fullTopicName=tb_rule_engine.main.3, myPartition=true), TopicPartitionInfo(topic=tb_rule_engine.main, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[0], fullTopicName=tb_rule_engine.main.0, myPartition=true), TopicPartitionInfo(topic=tb_rule_engine.main, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[1], fullTopicName=tb_rule_engine.main.1, myPartition=true)]})
2024-01-25 16:55:38,965 [device-state-scheduled-18-thread-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [Device State] CURRENT PARTITIONS: []
2024-01-25 16:55:38,966 [api-usage-scheduled-20-thread-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [API Usage] CURRENT PARTITIONS: []
2024-01-25 16:55:38,966 [device-state-scheduled-18-thread-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [Device State] NEW PARTITIONS: [TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[5], fullTopicName=tb_core.5, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[6], fullTopicName=tb_core.6, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[3], fullTopicName=tb_core.3, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[4], fullTopicName=tb_core.4, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[1], fullTopicName=tb_core.1, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[2], fullTopicName=tb_core.2, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[0], fullTopicName=tb_core.0, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[9], fullTopicName=tb_core.9, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[7], fullTopicName=tb_core.7, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[8], fullTopicName=tb_core.8, myPartition=true)]
2024-01-25 16:55:38,968 [notifications-scheduler-38-thread-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [Notifications scheduler] CURRENT PARTITIONS: []
2024-01-25 16:55:38,970 [device-state-scheduled-18-thread-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [Device State] ADDED PARTITIONS: [TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[5], fullTopicName=tb_core.5, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[6], fullTopicName=tb_core.6, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[3], fullTopicName=tb_core.3, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[4], fullTopicName=tb_core.4, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[1], fullTopicName=tb_core.1, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[2], fullTopicName=tb_core.2, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[0], fullTopicName=tb_core.0, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[9], fullTopicName=tb_core.9, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[7], fullTopicName=tb_core.7, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[8], fullTopicName=tb_core.8, myPartition=true)]
2024-01-25 16:55:38,972 [notifications-scheduler-38-thread-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [Notifications scheduler] NEW PARTITIONS: [TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[5], fullTopicName=tb_core.5, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[6], fullTopicName=tb_core.6, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[3], fullTopicName=tb_core.3, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[4], fullTopicName=tb_core.4, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[1], fullTopicName=tb_core.1, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[2], fullTopicName=tb_core.2, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[0], fullTopicName=tb_core.0, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[9], fullTopicName=tb_core.9, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[7], fullTopicName=tb_core.7, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[8], fullTopicName=tb_core.8, myPartition=true)]
2024-01-25 16:55:38,968 [main] INFO  o.t.s.s.q.DefaultTbCoreConsumerService - Subscribing to partitions: [TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[5], fullTopicName=tb_core.5, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[6], fullTopicName=tb_core.6, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[3], fullTopicName=tb_core.3, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[4], fullTopicName=tb_core.4, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[1], fullTopicName=tb_core.1, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[2], fullTopicName=tb_core.2, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[0], fullTopicName=tb_core.0, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[9], fullTopicName=tb_core.9, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[7], fullTopicName=tb_core.7, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[8], fullTopicName=tb_core.8, myPartition=true)]
2024-01-25 16:55:38,978 [device-state-scheduled-18-thread-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [Device State] REMOVED PARTITIONS: []
2024-01-25 16:55:38,969 [api-usage-scheduled-20-thread-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [API Usage] NEW PARTITIONS: [TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[5], fullTopicName=tb_core.5, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[6], fullTopicName=tb_core.6, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[3], fullTopicName=tb_core.3, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[4], fullTopicName=tb_core.4, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[1], fullTopicName=tb_core.1, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[2], fullTopicName=tb_core.2, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[0], fullTopicName=tb_core.0, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[9], fullTopicName=tb_core.9, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[7], fullTopicName=tb_core.7, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[8], fullTopicName=tb_core.8, myPartition=true)]
2024-01-25 16:55:38,983 [api-usage-scheduled-20-thread-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [API Usage] ADDED PARTITIONS: [TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[5], fullTopicName=tb_core.5, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[6], fullTopicName=tb_core.6, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[3], fullTopicName=tb_core.3, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[4], fullTopicName=tb_core.4, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[1], fullTopicName=tb_core.1, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[2], fullTopicName=tb_core.2, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[0], fullTopicName=tb_core.0, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[9], fullTopicName=tb_core.9, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[7], fullTopicName=tb_core.7, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[8], fullTopicName=tb_core.8, myPartition=true)]
2024-01-25 16:55:38,978 [notifications-scheduler-38-thread-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [Notifications scheduler] ADDED PARTITIONS: [TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[5], fullTopicName=tb_core.5, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[6], fullTopicName=tb_core.6, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[3], fullTopicName=tb_core.3, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[4], fullTopicName=tb_core.4, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[1], fullTopicName=tb_core.1, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[2], fullTopicName=tb_core.2, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[0], fullTopicName=tb_core.0, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[9], fullTopicName=tb_core.9, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[7], fullTopicName=tb_core.7, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[8], fullTopicName=tb_core.8, myPartition=true)]
2024-01-25 16:55:38,981 [main] INFO  o.t.s.a.service.DefaultActorService - Received partition change event.
2024-01-25 16:55:38,984 [api-usage-scheduled-20-thread-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [API Usage] REMOVED PARTITIONS: []
2024-01-25 16:55:38,987 [notifications-scheduler-38-thread-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [Notifications scheduler] REMOVED PARTITIONS: []
2024-01-25 16:55:38,996 [main] INFO  o.t.s.q.d.TbApplicationEventListener - Application event ignored due to invalid sequence number (3 > 3). Event: PartitionChangeEvent(super=TbApplicationEvent(sequenceNumber=3), serviceType=TB_CORE, partitionsMap={QK(Main,TB_CORE,system)=[TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[5], fullTopicName=tb_core.5, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[6], fullTopicName=tb_core.6, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[3], fullTopicName=tb_core.3, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[4], fullTopicName=tb_core.4, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[1], fullTopicName=tb_core.1, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[2], fullTopicName=tb_core.2, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[0], fullTopicName=tb_core.0, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[9], fullTopicName=tb_core.9, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[7], fullTopicName=tb_core.7, myPartition=true), TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[8], fullTopicName=tb_core.8, myPartition=true)]})
2024-01-25 16:55:39,002 [api-usage-scheduled-20-thread-1] INFO  o.t.s.s.a.DefaultTbApiUsageStateService - Initializing tenant states.
2024-01-25 16:55:39,004 [main] INFO  o.t.s.t.s.s.SnmpTransportBalancingService - Recalculating partitions for SNMP transports
2024-01-25 16:55:39,018 [main] INFO  o.t.s.t.s.s.SnmpTransportBalancingService - SNMP transports partitions have not changed
2024-01-25 16:55:39,147 [notifications-scheduler-38-thread-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [Notifications scheduler] Managing following partitions:
2024-01-25 16:55:39,149 [notifications-scheduler-38-thread-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [Notifications scheduler][tb_core.5]: 0 entities
2024-01-25 16:55:39,149 [notifications-scheduler-38-thread-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [Notifications scheduler][tb_core.6]: 0 entities
2024-01-25 16:55:39,150 [notifications-scheduler-38-thread-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [Notifications scheduler][tb_core.3]: 0 entities
2024-01-25 16:55:39,151 [notifications-scheduler-38-thread-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [Notifications scheduler][tb_core.4]: 0 entities
2024-01-25 16:55:39,152 [notifications-scheduler-38-thread-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [Notifications scheduler][tb_core.1]: 0 entities
2024-01-25 16:55:39,153 [notifications-scheduler-38-thread-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [Notifications scheduler][tb_core.2]: 0 entities
2024-01-25 16:55:39,155 [notifications-scheduler-38-thread-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [Notifications scheduler][tb_core.0]: 0 entities
2024-01-25 16:55:39,156 [notifications-scheduler-38-thread-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [Notifications scheduler][tb_core.9]: 0 entities
2024-01-25 16:55:39,158 [notifications-scheduler-38-thread-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [Notifications scheduler][tb_core.7]: 0 entities
2024-01-25 16:55:39,159 [notifications-scheduler-38-thread-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [Notifications scheduler][tb_core.8]: 0 entities
2024-01-25 16:55:39,274 [device-state-scheduled-18-thread-1] INFO  o.t.s.s.s.DefaultDeviceStateService - [TopicPartitionInfo(topic=tb_core, tenantId=Optional[13814000-1dd2-11b2-8080-808080808080], partition=Optional[7], fullTopicName=tb_core.7, myPartition=true)] Submit task for device states: 1
2024-01-25 16:55:39,347 [DbCallbackExecutorService-57-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 16:55:39,350 [DbCallbackExecutorService-57-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 16:55:39,396 [DbCallbackExecutorService-57-1] WARN  o.t.s.s.a.DefaultTbApiUsageStateService - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Failed to initialize tenant API state
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.lambda$onAddedPartitions$13(DefaultTbApiUsageStateService.java:531)
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:131)
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:74)
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:82)
	at java.base/java.util.concurrent.ForkJoinTask$RunnableExecuteAction.exec(ForkJoinTask.java:1426)
	at java.base/java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:290)
	at java.base/java.util.concurrent.ForkJoinPool$WorkQueue.topLevelExec(ForkJoinPool.java:1020)
	at java.base/java.util.concurrent.ForkJoinPool.scan(ForkJoinPool.java:1656)
	at java.base/java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1594)
	at java.base/java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:183)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 40 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 78 common frames omitted
2024-01-25 16:55:39,400 [DbCallbackExecutorService-57-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [API Usage] Managing following partitions:
2024-01-25 16:55:39,400 [DbCallbackExecutorService-57-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [API Usage][tb_core.5]: 0 entities
2024-01-25 16:55:39,401 [DbCallbackExecutorService-57-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [API Usage][tb_core.6]: 0 entities
2024-01-25 16:55:39,402 [DbCallbackExecutorService-57-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [API Usage][tb_core.3]: 0 entities
2024-01-25 16:55:39,403 [DbCallbackExecutorService-57-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [API Usage][tb_core.4]: 0 entities
2024-01-25 16:55:39,409 [DbCallbackExecutorService-57-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [API Usage][tb_core.1]: 0 entities
2024-01-25 16:55:39,411 [DbCallbackExecutorService-57-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [API Usage][tb_core.2]: 0 entities
2024-01-25 16:55:39,413 [DbCallbackExecutorService-57-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [API Usage][tb_core.0]: 0 entities
2024-01-25 16:55:39,415 [DbCallbackExecutorService-57-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [API Usage][tb_core.9]: 0 entities
2024-01-25 16:55:39,416 [DbCallbackExecutorService-57-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [API Usage][tb_core.7]: 0 entities
2024-01-25 16:55:39,417 [DbCallbackExecutorService-57-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [API Usage][tb_core.8]: 0 entities
2024-01-25 16:55:39,449 [device-state-1-1] INFO  o.t.s.s.s.DefaultDeviceStateService - [7] Initialized 1 out of 1 device states
2024-01-25 16:55:39,450 [device-state-1-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [Device State] Managing following partitions:
2024-01-25 16:55:39,451 [device-state-1-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [Device State][tb_core.5]: 0 entities
2024-01-25 16:55:39,452 [device-state-1-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [Device State][tb_core.6]: 0 entities
2024-01-25 16:55:39,459 [device-state-1-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [Device State][tb_core.3]: 0 entities
2024-01-25 16:55:39,461 [device-state-1-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [Device State][tb_core.4]: 0 entities
2024-01-25 16:55:39,462 [device-state-1-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [Device State][tb_core.1]: 0 entities
2024-01-25 16:55:39,463 [device-state-1-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [Device State][tb_core.2]: 0 entities
2024-01-25 16:55:39,464 [device-state-1-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [Device State][tb_core.0]: 0 entities
2024-01-25 16:55:39,465 [device-state-1-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [Device State][tb_core.9]: 0 entities
2024-01-25 16:55:39,466 [device-state-1-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [Device State][tb_core.7]: 1 entities
2024-01-25 16:55:39,466 [device-state-1-1] INFO  o.t.s.s.p.AbstractPartitionBasedService - [Device State][tb_core.8]: 0 entities
2024-01-25 16:55:39,513 [main] INFO  o.t.s.a.service.DefaultActorService - Received application ready event. Sending application init message to actor system
2024-01-25 16:55:39,515 [main] INFO  o.t.s.s.q.p.AbstractConsumerService - Subscribing to notifications: tb_core.notifications.138a9a50b9a6
2024-01-25 16:55:39,515 [app-dispatcher-52-thread-1] INFO  o.t.server.actors.app.AppActor - Starting main system actor.
2024-01-25 16:55:39,522 [tb-core-notifications-consumer-39-thread-1] INFO  o.t.s.s.q.DefaultTbCoreConsumerService - [138a9a50b9a6] Processing core startup with partitions: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
2024-01-25 16:55:39,529 [main] INFO  o.t.s.s.t.TbCoreTransportApiService - Received application ready event. Starting polling for events.
2024-01-25 16:55:39,534 [DefaultTbLocalSubscriptionService-25-1] INFO  o.t.s.s.s.DefaultTbLocalSubscriptionService - [138a9a50b9a6] Pushed 0 subscriptions to [138a9a50b9a6]
2024-01-25 16:55:39,535 [main] INFO  o.t.s.s.q.p.AbstractConsumerService - Subscribing to notifications: tb_rule_engine.notifications.138a9a50b9a6
2024-01-25 16:55:39,545 [tenant-dispatcher-1-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 16:55:39,546 [tenant-dispatcher-1-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 16:55:39,548 [app-dispatcher-52-thread-1] INFO  o.t.server.actors.app.AppActor - Main system actor started.
2024-01-25 16:55:39,550 [main] INFO  o.t.s.t.l.s.DefaultLwM2mTransportService - Unable to load X509 files for LWM2MServer
2024-01-25 16:55:39,557 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - Failed to check ApiUsage "ReExecEnabled"!!!
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.actors.tenant.TenantActor.getApiUsageState(TenantActor.java:299)
	at org.thingsboard.server.actors.tenant.TenantActor.init(TenantActor.java:95)
	at org.thingsboard.server.actors.TbActorMailbox.tryInit(TbActorMailbox.java:68)
	at org.thingsboard.server.actors.TbActorMailbox.lambda$initActor$0(TbActorMailbox.java:61)
	at java.base/java.util.concurrent.ForkJoinTask$RunnableExecuteAction.exec(ForkJoinTask.java:1426)
	at java.base/java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:290)
	at java.base/java.util.concurrent.ForkJoinPool$WorkQueue.topLevelExec(ForkJoinPool.java:1020)
	at java.base/java.util.concurrent.ForkJoinPool.scan(ForkJoinPool.java:1656)
	at java.base/java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1594)
	at java.base/java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:183)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 16:55:39,570 [main] INFO  o.e.c.c.network.RandomTokenGenerator - using tokens of 8 bytes in length
2024-01-25 16:55:39,578 [main] INFO  o.e.c.core.network.CoapEndpoint - [LWM2M Server-coap://] CoapEndpoint uses udp context
2024-01-25 16:55:39,580 [main] INFO  o.e.c.c.network.stack.BlockwiseLayer - [LWM2M Server-coap://] BlockwiseLayer uses MAX_MESSAGE_SIZE=1024, PREFERRED_BLOCK_SIZE=1024, BLOCKWISE_STATUS_LIFETIME=300000, MAX_RESOURCE_BODY_SIZE=268435456, BLOCKWISE_STRICT_BLOCK2_OPTION=true
2024-01-25 16:55:39,581 [main] INFO  o.e.c.s.dtls.InMemoryConnectionStore - Created new InMemoryConnectionStore [capacity: 150000, connection expiration threshold: 1800s]
2024-01-25 16:55:39,586 [main] INFO  o.e.c.c.network.RandomTokenGenerator - using tokens of 8 bytes in length
2024-01-25 16:55:39,591 [main] INFO  o.e.c.core.network.CoapEndpoint - [LWM2M Server-coaps://] CoapEndpoint uses lwm2m correlation
2024-01-25 16:55:39,596 [main] INFO  o.e.c.c.network.stack.BlockwiseLayer - [LWM2M Server-coaps://] BlockwiseLayer uses MAX_MESSAGE_SIZE=1024, PREFERRED_BLOCK_SIZE=1024, BLOCKWISE_STATUS_LIFETIME=300000, MAX_RESOURCE_BODY_SIZE=268435456, BLOCKWISE_STRICT_BLOCK2_OPTION=true
2024-01-25 16:55:39,647 [main] INFO  o.t.s.t.l.s.DefaultLwM2mTransportService - Starting LwM2M transport server...
2024-01-25 16:55:39,650 [main] INFO  o.e.californium.core.CoapServer - Starting server
2024-01-25 16:55:39,653 [main] INFO  o.e.c.elements.UDPConnector - UDPConnector starts up 2 sender threads and 2 receiver threads
2024-01-25 16:55:39,657 [main] INFO  o.e.c.elements.UDPConnector - UDPConnector listening on 0.0.0.0/0.0.0.0:5685, recv buf = 106496, send buf = 106496, recv packet size = 2048
2024-01-25 16:55:39,658 [main] INFO  o.e.c.core.network.CoapEndpoint - [LWM2M Server-coap://] Started endpoint at coap://0.0.0.0:5685
2024-01-25 16:55:39,659 [main] INFO  o.e.c.scandium.DTLSConnector - multiple network interfaces, using smallest MTU [IPv4 1500, IPv6 1280]
2024-01-25 16:55:39,663 [DTLS-Receiver-0-0.0.0.0/0.0.0.0:5686] INFO  o.e.c.scandium.DTLSConnector - Starting worker thread [DTLS-Receiver-0-0.0.0.0/0.0.0.0:5686]
2024-01-25 16:55:39,663 [DTLS-Receiver-1-0.0.0.0/0.0.0.0:5686] INFO  o.e.c.scandium.DTLSConnector - Starting worker thread [DTLS-Receiver-1-0.0.0.0/0.0.0.0:5686]
2024-01-25 16:55:39,663 [main] INFO  o.e.c.scandium.DTLSConnector - DTLSConnector listening on 0.0.0.0/0.0.0.0:5686, recv buf = 106496, send buf = 106496, recv packet size = 16490, MTU = IPv4 1500 / IPv6 1280
2024-01-25 16:55:39,667 [main] INFO  o.e.c.core.network.CoapEndpoint - [LWM2M Server-coaps://] Started endpoint at coaps://0.0.0.0:5686
2024-01-25 16:55:39,668 [main] INFO  o.e.l.s.californium.LeshanServer - LWM2M server started at coap://0.0.0.0/0.0.0.0:5685 coaps://0.0.0.0/0.0.0.0:5686
2024-01-25 16:55:39,680 [main] INFO  o.t.s.t.l.s.DefaultLwM2mTransportService - Started LwM2M transport server.
2024-01-25 16:55:39,681 [main] INFO  o.t.s.t.snmp.SnmpTransportContext - Initializing SNMP devices sessions
2024-01-25 16:55:39,927 [tb-rule-engine-mgmt-9-1] INFO  o.t.s.s.q.r.TbRuleEngineQueueConsumerManager - [QK(HighPriority,TB_RULE_ENGINE,system)] Added partitions: [tb_rule_engine.hp.9, tb_rule_engine.hp.7, tb_rule_engine.hp.8, tb_rule_engine.hp.5, tb_rule_engine.hp.6, tb_rule_engine.hp.3, tb_rule_engine.hp.4, tb_rule_engine.hp.1, tb_rule_engine.hp.2, tb_rule_engine.hp.0], removed partitions: []
2024-01-25 16:55:39,927 [tb-rule-engine-mgmt-2-2] INFO  o.t.s.s.q.r.TbRuleEngineQueueConsumerManager - [QK(SequentialByOriginator,TB_RULE_ENGINE,system)] Added partitions: [tb_rule_engine.sq.9, tb_rule_engine.sq.8, tb_rule_engine.sq.7, tb_rule_engine.sq.2, tb_rule_engine.sq.1, tb_rule_engine.sq.0, tb_rule_engine.sq.6, tb_rule_engine.sq.5, tb_rule_engine.sq.4, tb_rule_engine.sq.3], removed partitions: []
2024-01-25 16:55:39,928 [tb-rule-engine-mgmt-11-3] INFO  o.t.s.s.q.r.TbRuleEngineQueueConsumerManager - [QK(Main,TB_RULE_ENGINE,system)] Added partitions: [tb_rule_engine.main.8, tb_rule_engine.main.9, tb_rule_engine.main.6, tb_rule_engine.main.7, tb_rule_engine.main.4, tb_rule_engine.main.5, tb_rule_engine.main.2, tb_rule_engine.main.3, tb_rule_engine.main.0, tb_rule_engine.main.1], removed partitions: []
2024-01-25 16:55:39,930 [tb-rule-engine-mgmt-2-2] INFO  o.t.s.s.q.r.TbRuleEngineQueueConsumerManager - [QK(SequentialByOriginator,TB_RULE_ENGINE,system)-9] Launching consumer
2024-01-25 16:55:39,931 [tb-rule-engine-mgmt-9-1] INFO  o.t.s.s.q.r.TbRuleEngineQueueConsumerManager - [QK(HighPriority,TB_RULE_ENGINE,system)-9] Launching consumer
2024-01-25 16:55:39,931 [tb-rule-engine-mgmt-11-3] INFO  o.t.s.s.q.r.TbRuleEngineQueueConsumerManager - [QK(Main,TB_RULE_ENGINE,system)-8] Launching consumer
2024-01-25 16:55:39,934 [tb-rule-engine-mgmt-9-1] INFO  o.t.s.s.q.r.TbRuleEngineQueueConsumerManager - [QK(HighPriority,TB_RULE_ENGINE,system)-7] Launching consumer
2024-01-25 16:55:39,934 [tb-rule-engine-mgmt-11-3] INFO  o.t.s.s.q.r.TbRuleEngineQueueConsumerManager - [QK(Main,TB_RULE_ENGINE,system)-9] Launching consumer
2024-01-25 16:55:39,932 [tb-rule-engine-mgmt-2-2] INFO  o.t.s.s.q.r.TbRuleEngineQueueConsumerManager - [QK(SequentialByOriginator,TB_RULE_ENGINE,system)-8] Launching consumer
2024-01-25 16:55:39,935 [tb-rule-engine-mgmt-9-1] INFO  o.t.s.s.q.r.TbRuleEngineQueueConsumerManager - [QK(HighPriority,TB_RULE_ENGINE,system)-8] Launching consumer
2024-01-25 16:55:39,935 [tb-rule-engine-mgmt-11-3] INFO  o.t.s.s.q.r.TbRuleEngineQueueConsumerManager - [QK(Main,TB_RULE_ENGINE,system)-6] Launching consumer
2024-01-25 16:55:39,936 [tb-rule-engine-mgmt-2-2] INFO  o.t.s.s.q.r.TbRuleEngineQueueConsumerManager - [QK(SequentialByOriginator,TB_RULE_ENGINE,system)-7] Launching consumer
2024-01-25 16:55:39,937 [tb-rule-engine-mgmt-9-1] INFO  o.t.s.s.q.r.TbRuleEngineQueueConsumerManager - [QK(HighPriority,TB_RULE_ENGINE,system)-5] Launching consumer
2024-01-25 16:55:39,938 [tb-rule-engine-mgmt-11-3] INFO  o.t.s.s.q.r.TbRuleEngineQueueConsumerManager - [QK(Main,TB_RULE_ENGINE,system)-7] Launching consumer
2024-01-25 16:55:39,942 [tb-rule-engine-mgmt-9-1] INFO  o.t.s.s.q.r.TbRuleEngineQueueConsumerManager - [QK(HighPriority,TB_RULE_ENGINE,system)-6] Launching consumer
2024-01-25 16:55:39,943 [tb-rule-engine-mgmt-11-3] INFO  o.t.s.s.q.r.TbRuleEngineQueueConsumerManager - [QK(Main,TB_RULE_ENGINE,system)-4] Launching consumer
2024-01-25 16:55:39,943 [tb-rule-engine-mgmt-2-2] INFO  o.t.s.s.q.r.TbRuleEngineQueueConsumerManager - [QK(SequentialByOriginator,TB_RULE_ENGINE,system)-2] Launching consumer
2024-01-25 16:55:39,944 [tb-rule-engine-mgmt-9-1] INFO  o.t.s.s.q.r.TbRuleEngineQueueConsumerManager - [QK(HighPriority,TB_RULE_ENGINE,system)-3] Launching consumer
2024-01-25 16:55:39,944 [tb-rule-engine-mgmt-11-3] INFO  o.t.s.s.q.r.TbRuleEngineQueueConsumerManager - [QK(Main,TB_RULE_ENGINE,system)-5] Launching consumer
2024-01-25 16:55:39,945 [tb-rule-engine-mgmt-2-2] INFO  o.t.s.s.q.r.TbRuleEngineQueueConsumerManager - [QK(SequentialByOriginator,TB_RULE_ENGINE,system)-1] Launching consumer
2024-01-25 16:55:39,945 [tb-rule-engine-mgmt-9-1] INFO  o.t.s.s.q.r.TbRuleEngineQueueConsumerManager - [QK(HighPriority,TB_RULE_ENGINE,system)-4] Launching consumer
2024-01-25 16:55:39,946 [tb-rule-engine-mgmt-11-3] INFO  o.t.s.s.q.r.TbRuleEngineQueueConsumerManager - [QK(Main,TB_RULE_ENGINE,system)-2] Launching consumer
2024-01-25 16:55:39,947 [tb-rule-engine-mgmt-2-2] INFO  o.t.s.s.q.r.TbRuleEngineQueueConsumerManager - [QK(SequentialByOriginator,TB_RULE_ENGINE,system)-0] Launching consumer
2024-01-25 16:55:39,947 [tb-rule-engine-mgmt-9-1] INFO  o.t.s.s.q.r.TbRuleEngineQueueConsumerManager - [QK(HighPriority,TB_RULE_ENGINE,system)-1] Launching consumer
2024-01-25 16:55:39,948 [tb-rule-engine-mgmt-11-3] INFO  o.t.s.s.q.r.TbRuleEngineQueueConsumerManager - [QK(Main,TB_RULE_ENGINE,system)-3] Launching consumer
2024-01-25 16:55:39,949 [tb-rule-engine-mgmt-2-2] INFO  o.t.s.s.q.r.TbRuleEngineQueueConsumerManager - [QK(SequentialByOriginator,TB_RULE_ENGINE,system)-6] Launching consumer
2024-01-25 16:55:39,951 [tb-rule-engine-mgmt-9-1] INFO  o.t.s.s.q.r.TbRuleEngineQueueConsumerManager - [QK(HighPriority,TB_RULE_ENGINE,system)-2] Launching consumer
2024-01-25 16:55:39,951 [tb-rule-engine-mgmt-2-2] INFO  o.t.s.s.q.r.TbRuleEngineQueueConsumerManager - [QK(SequentialByOriginator,TB_RULE_ENGINE,system)-5] Launching consumer
2024-01-25 16:55:39,951 [tb-rule-engine-mgmt-11-3] INFO  o.t.s.s.q.r.TbRuleEngineQueueConsumerManager - [QK(Main,TB_RULE_ENGINE,system)-0] Launching consumer
2024-01-25 16:55:39,952 [tb-rule-engine-mgmt-9-1] INFO  o.t.s.s.q.r.TbRuleEngineQueueConsumerManager - [QK(HighPriority,TB_RULE_ENGINE,system)-0] Launching consumer
2024-01-25 16:55:39,953 [tb-rule-engine-mgmt-2-2] INFO  o.t.s.s.q.r.TbRuleEngineQueueConsumerManager - [QK(SequentialByOriginator,TB_RULE_ENGINE,system)-4] Launching consumer
2024-01-25 16:55:39,954 [tb-rule-engine-mgmt-11-3] INFO  o.t.s.s.q.r.TbRuleEngineQueueConsumerManager - [QK(Main,TB_RULE_ENGINE,system)-1] Launching consumer
2024-01-25 16:55:39,958 [tb-rule-engine-mgmt-2-2] INFO  o.t.s.s.q.r.TbRuleEngineQueueConsumerManager - [QK(SequentialByOriginator,TB_RULE_ENGINE,system)-3] Launching consumer
2024-01-25 16:55:40,005 [tb-system-info-scheduler-59-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 16:55:40,008 [tb-system-info-scheduler-59-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 16:55:40,912 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:55:43,911 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:55:46,911 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:55:49,912 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:55:52,912 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:55:55,912 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:55:58,912 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:56:01,912 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:56:04,913 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:56:07,913 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:56:10,913 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:56:13,913 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:56:16,914 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:56:19,914 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:56:20,111 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 16:56:20,112 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 16:56:20,116 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [cd5ed734-5c41-4a58-96e3-026367f9dd74] Failed to process usage stats: TbProtoQueueMsg(key=964af6ef-9890-4b84-a1a1-2eab9413f565, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@6da877f4)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 16:56:22,915 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:56:25,915 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:56:28,915 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:56:31,916 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:56:32,619 [https-jsse-nio-0.0.0.0-9090-exec-7] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2024-01-25 16:56:32,620 [https-jsse-nio-0.0.0.0-9090-exec-7] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2024-01-25 16:56:32,624 [https-jsse-nio-0.0.0.0-9090-exec-7] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 3 ms
2024-01-25 16:56:34,916 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:56:37,916 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:56:38,730 [TB-Scheduling-5] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 16:56:38,731 [TB-Scheduling-1] INFO  o.t.s.s.queue.TbCoreConsumerStats - Core Stats: totalMsgs = [1] sessionEvents = [0] getAttr = [0] subToAttr = [0] subToRpc = [0] toDevRpc = [0] subInfo = [0] claimDevice = [0] deviceState = [0] subMsgs = [0] edgeNfs = [0] deviceActivity = [0] coreNfOther = [1] coreNfCompLfcl = [0] coreNfDevRpcRsp = [0] coreNfEdgeUpd = [0] coreNfEdgeSyncReq = [0] coreNfEdgeSyncResp = [0] coreNfNfRlProc = [0] coreNfQueueUpd = [0] coreNfQueueDel = [0] coreNfSubSvc = [0] coreNfSubMgr = [0] coreNfVCRsp = [0] 
2024-01-25 16:56:38,732 [TB-Scheduling-5] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 4, failures: 3, exec time: 182 
2024-01-25 16:56:38,733 [TB-Scheduling-5] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 16:56:38,734 [TB-Scheduling-6] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [0]
2024-01-25 16:56:38,735 [TB-Scheduling-5] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 3, failures: 3, exec time: 123
2024-01-25 16:56:38,736 [TB-Scheduling-5] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaAbstractDao.findById(..), calls: 1, failures: 0, exec time: 59
2024-01-25 16:56:40,916 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:56:43,916 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:56:46,916 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:56:49,916 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:56:52,916 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:56:55,917 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:56:58,917 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:57:01,917 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:57:04,918 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:57:07,918 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:57:10,918 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:57:13,918 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:57:16,918 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:57:19,918 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:57:20,115 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 16:57:20,117 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 16:57:20,120 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [3728e40a-1e85-45ca-93dd-45a94fd1cef8] Failed to process usage stats: TbProtoQueueMsg(key=90899cf3-bc35-4d8c-b044-99464361ccbe, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@681e1887)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 16:57:22,919 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:57:25,919 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:57:28,919 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:57:31,920 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:57:34,920 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:57:37,920 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:57:38,734 [TB-Scheduling-2] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [0]
2024-01-25 16:57:38,735 [TB-Scheduling-4] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 16:57:38,736 [TB-Scheduling-4] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 1, failures: 1, exec time: 6 
2024-01-25 16:57:38,737 [TB-Scheduling-4] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 16:57:38,738 [TB-Scheduling-4] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 1, failures: 1, exec time: 6
2024-01-25 16:57:40,920 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:57:43,920 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:57:46,921 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:57:49,921 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:57:52,921 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:57:55,922 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:57:58,922 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:58:01,922 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:58:04,922 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:58:07,923 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:58:10,923 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:58:13,923 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:58:16,924 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:58:19,924 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:58:20,127 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 16:58:20,129 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 16:58:20,133 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [1b261d68-6b25-401c-b104-fade714dd3c6] Failed to process usage stats: TbProtoQueueMsg(key=9ea084ae-2ee4-4a28-9e31-3fb17e9bc402, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@67c4bab6)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 16:58:22,924 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:58:25,924 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:58:28,925 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:58:31,925 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:58:34,925 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:58:37,926 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:58:38,735 [TB-Scheduling-2] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [0]
2024-01-25 16:58:38,738 [TB-Scheduling-5] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 16:58:38,739 [TB-Scheduling-5] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 1, failures: 1, exec time: 7 
2024-01-25 16:58:38,739 [TB-Scheduling-5] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 16:58:38,740 [TB-Scheduling-5] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 1, failures: 1, exec time: 7
2024-01-25 16:58:40,926 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:58:43,926 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:58:46,926 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:58:49,927 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:58:52,927 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:58:55,927 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:58:58,928 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:59:01,928 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:59:04,928 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:59:07,929 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:59:10,929 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:59:13,929 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:59:16,929 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:59:19,929 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:59:20,124 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 16:59:20,126 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 16:59:20,128 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [a5365f4a-f2c3-4b93-b18a-e635c589924e] Failed to process usage stats: TbProtoQueueMsg(key=595f113d-87bb-4431-8814-2bf8a84f7168, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@2acb6597)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 16:59:22,930 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:59:25,930 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:59:28,930 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:59:31,930 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:59:34,931 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:59:37,931 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:59:38,737 [TB-Scheduling-6] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [0]
2024-01-25 16:59:38,740 [TB-Scheduling-1] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 16:59:38,741 [TB-Scheduling-1] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 1, failures: 1, exec time: 6 
2024-01-25 16:59:38,742 [TB-Scheduling-1] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 16:59:38,743 [TB-Scheduling-1] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 1, failures: 1, exec time: 6
2024-01-25 16:59:40,931 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:59:43,009 [https-jsse-nio-0.0.0.0-9090-exec-1] INFO  org.owasp.validator.html.Policy - Attempting to load AntiSamy policy from an input stream.
2024-01-25 16:59:43,209 [https-jsse-nio-0.0.0.0-9090-exec-1] WARN  org.owasp.validator.html.Policy - The directive "noopenerAndNoreferrerAnchors" is enabled by default, but disabled in this policy. It is recommended to leave it enabled to prevent reverse tabnabbing attacks.
2024-01-25 16:59:43,682 [https-jsse-nio-0.0.0.0-9090-exec-1] INFO  c.d.oss.driver.api.core.uuid.Uuids - PID obtained through JMX: 22
2024-01-25 16:59:43,706 [JpaExecutorService-9-1] INFO  o.t.s.d.s.i.s.SqlPartitioningRepository - Saving partition 1706140800000-1706745600000 for table audit_log
2024-01-25 16:59:43,932 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:59:45,040 [https-jsse-nio-0.0.0.0-9090-exec-8] INFO  o.t.s.c.plugin.TbWebSocketHandler - [13814000-1dd2-11b2-8080-808080808080][0d929340-6dfc-11ee-9984-2b8a0281ea3f][50ebaf7f-fa21-45c0-954f-eff824bb46e2][7dae3589-6cea-9f21-5f3c-decc34d03d8c] Session established from address: /172.19.0.1:59428
2024-01-25 16:59:46,932 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:59:48,741 [TB-Scheduling-2] INFO  o.t.s.s.s.DefaultTbEntityDataSubscriptionService - Stats: regularQueryInvocationCnt = [12], regularQueryInvocationTime = [268], dynamicQueryCnt = [10] dynamicQueryInvocationCnt = [0], dynamicQueryInvocationTime = [0], alarmQueryInvocationCnt = [0], alarmQueryInvocationTime = [0]
2024-01-25 16:59:49,932 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:59:52,933 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:59:54,534 [https-jsse-nio-0.0.0.0-9090-exec-10] INFO  o.t.s.c.plugin.TbWebSocketHandler - [13814000-1dd2-11b2-8080-808080808080][0d929340-6dfc-11ee-9984-2b8a0281ea3f][50ebaf7f-fa21-45c0-954f-eff824bb46e2] Session is closed
2024-01-25 16:59:55,933 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 16:59:58,933 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:00:01,933 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:00:04,934 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:00:07,934 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:00:08,515 [https-jsse-nio-0.0.0.0-9090-exec-9] INFO  o.t.s.c.plugin.TbWebSocketHandler - [129adff0-6dfc-11ee-9984-2b8a0281ea3f][133d8890-6dfc-11ee-9984-2b8a0281ea3f][0927cc96-40ea-4512-ade9-32eee865ee8d][82ae8cba-7a42-6446-9092-59d6d908a0a5] Session established from address: /172.19.0.1:38662
2024-01-25 17:00:09,161 [https-jsse-nio-0.0.0.0-9090-exec-7] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:00:09,163 [https-jsse-nio-0.0.0.0-9090-exec-7] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:00:10,934 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:00:13,934 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:00:16,935 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:00:18,743 [TB-Scheduling-7] INFO  o.t.s.s.s.DefaultTbEntityDataSubscriptionService - Stats: regularQueryInvocationCnt = [4], regularQueryInvocationTime = [24], dynamicQueryCnt = [0] dynamicQueryInvocationCnt = [0], dynamicQueryInvocationTime = [0], alarmQueryInvocationCnt = [3], alarmQueryInvocationTime = [33]
2024-01-25 17:00:19,935 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:00:20,119 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:00:20,121 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:00:20,123 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [d316305e-665f-4c50-bd2b-ddede4b1344c] Failed to process usage stats: TbProtoQueueMsg(key=b271e8d2-4b55-40d4-972b-734c524b8b76, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@7c86dd42)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 17:00:22,936 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:00:25,936 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:00:28,936 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:00:31,936 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:00:34,936 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:00:37,937 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:00:38,739 [TB-Scheduling-7] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [0]
2024-01-25 17:00:38,743 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 17:00:38,744 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 36, failures: 2, exec time: 212 
2024-01-25 17:00:38,745 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 17:00:38,745 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaAlarmDao.countAlarmsByQuery(..), calls: 3, failures: 0, exec time: 29
2024-01-25 17:00:38,746 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaDeviceProfileDao.findDeviceProfiles(..), calls: 1, failures: 0, exec time: 25
2024-01-25 17:00:38,746 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaOtaPackageInfoDao.findOtaPackageInfoByTenantId(..), calls: 1, failures: 0, exec time: 24
2024-01-25 17:00:40,937 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:00:43,937 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:00:46,938 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:00:49,938 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:00:52,938 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:00:55,939 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:00:58,939 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:01:01,939 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:01:04,939 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:01:07,940 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:01:10,940 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:01:13,940 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:01:16,940 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:01:18,547 [nioEventLoopGroup-4-1] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:01:18,769 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:01:18,771 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:01:18,774 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [1f8f977f-ae4c-4f14-886b-140c8ae267a1] Failed to process the request: TbProtoQueueMsg(key=5dad79ba-ccaa-435d-9c1e-cb6a03b9e266, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@31f83292)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:01:19,941 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:01:20,123 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:01:20,124 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:01:20,127 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [aa44bda8-f982-4d30-93b7-812276ca513c] Failed to process usage stats: TbProtoQueueMsg(key=bf1d3451-17d7-461a-805f-c8ef25441563, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@6fb10769)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 17:01:22,941 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:01:25,941 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:01:28,941 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:01:31,942 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:01:34,942 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:01:37,004 [nioEventLoopGroup-4-2] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:01:37,040 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:01:37,041 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:01:37,043 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [1476f282-8086-4c34-9f51-a01eed19efd2] Failed to process the request: TbProtoQueueMsg(key=03fed2ff-e4d1-4315-82d8-16cdd87f1162, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@5207771f)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:01:37,942 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:01:38,740 [TB-Scheduling-5] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [1]
2024-01-25 17:01:38,747 [TB-Scheduling-4] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 17:01:38,748 [TB-Scheduling-4] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 4, failures: 3, exec time: 23 
2024-01-25 17:01:38,749 [TB-Scheduling-4] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 17:01:38,749 [TB-Scheduling-4] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 3, failures: 3, exec time: 18
2024-01-25 17:01:38,750 [TB-Scheduling-4] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaAbstractDao.findById(..), calls: 1, failures: 0, exec time: 5
2024-01-25 17:01:40,942 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:01:43,942 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:01:46,942 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:01:49,942 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:01:52,943 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:01:55,225 [nioEventLoopGroup-4-3] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:01:55,284 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:01:55,285 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:01:55,287 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [8e597d1b-e3cc-4c90-ac6c-ff828e6f1b37] Failed to process the request: TbProtoQueueMsg(key=438f8f39-391a-4468-b5a4-c5f158cb5786, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@24f50638)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:01:55,943 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:01:58,943 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:02:01,944 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:02:04,944 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:02:07,944 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:02:10,944 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:02:13,475 [nioEventLoopGroup-4-4] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:02:13,513 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:02:13,513 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:02:13,514 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [9622e0cd-046a-45f1-aef0-b1213816ef92] Failed to process the request: TbProtoQueueMsg(key=79889265-2db4-4083-89fa-5239f4cd8411, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@2750f734)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:02:13,944 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:02:16,945 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:02:19,945 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:02:20,126 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:02:20,127 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:02:20,130 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [ad5c2e59-9f2d-4f3d-8aeb-588f61065d6b] Failed to process usage stats: TbProtoQueueMsg(key=4df6aea9-107b-4e32-8c6d-6f5f6fec4a98, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@544a6436)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 17:02:22,945 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:02:25,946 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:02:28,946 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:02:31,938 [nioEventLoopGroup-4-5] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:02:31,947 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:02:32,014 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:02:32,016 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:02:32,018 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [c1a302ad-e995-4dd2-8f2a-05d5620b9525] Failed to process the request: TbProtoQueueMsg(key=40e1e8a4-ec53-4d86-8e05-403fd0755672, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@2e7256ee)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:02:34,947 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:02:37,947 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:02:38,742 [TB-Scheduling-3] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [1]
2024-01-25 17:02:38,749 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 17:02:38,750 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 4, failures: 4, exec time: 16 
2024-01-25 17:02:38,751 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 17:02:38,752 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 4, failures: 4, exec time: 16
2024-01-25 17:02:40,947 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:02:43,946 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:02:46,946 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:02:49,946 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:02:50,067 [nioEventLoopGroup-4-6] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:02:51,191 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:02:51,194 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:02:51,197 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [73c0622f-394d-423a-82a8-fa2702ce6e62] Failed to process the request: TbProtoQueueMsg(key=0218e32f-116f-4d83-a1f6-bfebf0de1e69, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@6b963586)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:02:52,947 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:02:55,947 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:02:58,947 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:03:01,947 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:03:04,947 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:03:07,948 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:03:08,271 [nioEventLoopGroup-4-7] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:03:08,330 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:03:08,335 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:03:08,339 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [1f3f188b-2f0c-4029-8316-92e14e0aae57] Failed to process the request: TbProtoQueueMsg(key=ab2c59ef-8528-4e29-b9a0-f4f08880edcf, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@501de5db)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:03:10,948 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:03:13,950 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:03:16,950 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:03:19,951 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:03:20,132 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:03:20,133 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:03:20,135 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [4c0f3a2d-9144-4637-a58f-225830ce9b32] Failed to process usage stats: TbProtoQueueMsg(key=e4c0d02d-87cc-48b6-9baf-bd25dfe3ed89, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@6983db82)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 17:03:22,951 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:03:25,951 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:03:26,694 [nioEventLoopGroup-4-8] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:03:26,763 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:03:26,765 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:03:26,770 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [1442221b-6cb1-4138-aa26-51970aa08834] Failed to process the request: TbProtoQueueMsg(key=d55f611a-40e5-409a-9989-af0bc75bd2e5, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@f51bb63)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:03:28,951 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:03:31,951 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:03:34,952 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:03:37,952 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:03:38,744 [TB-Scheduling-8] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [0]
2024-01-25 17:03:38,753 [TB-Scheduling-1] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 17:03:38,755 [TB-Scheduling-1] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 4, failures: 4, exec time: 35 
2024-01-25 17:03:38,756 [TB-Scheduling-1] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 17:03:38,757 [TB-Scheduling-1] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 4, failures: 4, exec time: 35
2024-01-25 17:03:40,952 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:03:43,952 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:03:45,789 [nioEventLoopGroup-4-9] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:03:45,870 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:03:45,875 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:03:45,878 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [0aaf4958-e99a-455a-938e-fde9bf1ad13e] Failed to process the request: TbProtoQueueMsg(key=bd396d5a-01f8-4cb6-82c8-4a5b824d0afc, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@603605ee)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:03:46,953 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:03:49,953 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:03:52,953 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:03:55,953 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:03:58,954 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:04:01,954 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:04:04,593 [nioEventLoopGroup-4-10] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:04:04,667 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:04:04,669 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:04:04,671 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [6182d907-a02b-4de8-a681-f49e1618e754] Failed to process the request: TbProtoQueueMsg(key=f85e7f79-45cc-4142-8d66-3dba5622ecc7, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@1441d4b5)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:04:04,954 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:04:07,954 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:04:10,954 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:04:13,954 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:04:16,955 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:04:19,955 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:04:20,140 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:04:20,145 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:04:20,148 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [788d132c-5563-411a-a1d6-1c3627bfe5ef] Failed to process usage stats: TbProtoQueueMsg(key=6c2c2609-1973-427e-9abd-56d3322d85c0, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@4f357780)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 17:04:22,955 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:04:23,422 [nioEventLoopGroup-4-11] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:04:23,492 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:04:23,494 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:04:23,497 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [e725adb9-dc61-494e-a25b-997fbc893bca] Failed to process the request: TbProtoQueueMsg(key=333cf345-7ba6-47c5-9853-0b123f512aa0, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@5a034fa6)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:04:25,956 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:04:28,956 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:04:31,956 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:04:34,957 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:04:37,957 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:04:38,746 [TB-Scheduling-1] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [0]
2024-01-25 17:04:38,758 [TB-Scheduling-5] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 17:04:38,759 [TB-Scheduling-5] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 4, failures: 4, exec time: 35 
2024-01-25 17:04:38,759 [TB-Scheduling-5] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 17:04:38,760 [TB-Scheduling-5] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 4, failures: 4, exec time: 35
2024-01-25 17:04:40,958 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:04:42,081 [nioEventLoopGroup-4-12] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:04:42,133 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:04:42,134 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:04:42,136 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [697bf707-cd37-4da6-8f5c-36fcf209e739] Failed to process the request: TbProtoQueueMsg(key=cab47807-6088-4c35-b1c4-4195f27c1c3a, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@319e4142)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:04:43,958 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:04:46,958 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:04:49,958 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:04:52,958 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:04:55,959 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:04:58,959 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:05:00,782 [nioEventLoopGroup-4-1] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:05:01,274 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:05:01,276 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:05:01,278 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [6f733024-d3c9-46bf-bf64-e1e6565b189f] Failed to process the request: TbProtoQueueMsg(key=a57cbc5c-421f-41f1-b42e-5a6b757d61a5, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@16e2a11a)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:05:01,959 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:05:04,960 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:05:07,960 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:05:10,960 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:05:13,960 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:05:16,962 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:05:18,878 [nioEventLoopGroup-4-2] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:05:18,938 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:05:18,938 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:05:18,940 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [462a1e15-b45c-408c-97be-9153992aa3d2] Failed to process the request: TbProtoQueueMsg(key=6c735653-9978-4ca6-a11f-44794d241799, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@6a0d31c8)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:05:19,961 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:05:20,147 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:05:20,149 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:05:20,151 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [f78a6788-bc6b-452d-8b77-490fa9fd9a04] Failed to process usage stats: TbProtoQueueMsg(key=b27cf704-6c37-4d2e-9e1c-d7ec57b64523, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@5aa407ea)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 17:05:22,961 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:05:25,962 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:05:28,962 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:05:31,962 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:05:34,963 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:05:37,247 [nioEventLoopGroup-4-3] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:05:37,291 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:05:37,292 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:05:37,294 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [6aeab4c6-d634-4a32-892a-423c5eb567f7] Failed to process the request: TbProtoQueueMsg(key=8ab27fce-5f58-42f4-9821-b73c461feb55, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@2e0d4f6c)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:05:37,963 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:05:38,747 [TB-Scheduling-5] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [1]
2024-01-25 17:05:38,761 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 17:05:38,762 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 5, failures: 5, exec time: 25 
2024-01-25 17:05:38,762 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 17:05:38,763 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 5, failures: 5, exec time: 25
2024-01-25 17:05:40,963 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:05:43,959 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:05:46,959 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:05:49,959 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:05:52,959 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:05:55,610 [nioEventLoopGroup-4-4] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:05:55,645 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:05:55,646 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:05:55,647 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [ec89bfe4-03d6-4e15-9dd1-5ebfd6e74f5c] Failed to process the request: TbProtoQueueMsg(key=6bde354f-9a91-4b11-9307-d67b16c0677b, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@b51eee4)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:05:55,960 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:05:58,960 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:06:01,960 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:06:04,960 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:06:07,961 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:06:10,961 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:06:13,960 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:06:14,306 [nioEventLoopGroup-4-5] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:06:14,362 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:06:14,363 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:06:14,365 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [feff9cad-f5e8-47cd-a1ea-c317cab50ffd] Failed to process the request: TbProtoQueueMsg(key=8518cf64-7b08-48d9-a87f-631fe8151d64, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@32e82d7d)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:06:16,960 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:06:19,960 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:06:20,140 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:06:20,141 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:06:20,143 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [5eda3fe8-0e81-44d9-a326-6855013c0138] Failed to process usage stats: TbProtoQueueMsg(key=5e4d6882-cabd-4d85-939a-01195b457c30, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@7dd43d43)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 17:06:22,961 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:06:25,961 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:06:28,961 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:06:31,961 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:06:33,451 [nioEventLoopGroup-4-6] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:06:33,520 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:06:33,521 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:06:33,523 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [b8963628-2192-4429-9bf5-0fd569f5d533] Failed to process the request: TbProtoQueueMsg(key=531f77a9-b2de-49da-abcc-85e216da79bf, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@6b8e1aab)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:06:34,961 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:06:37,962 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:06:38,743 [TB-Scheduling-3] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [1]
2024-01-25 17:06:38,759 [TB-Scheduling-8] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 17:06:38,759 [TB-Scheduling-8] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 4, failures: 4, exec time: 16 
2024-01-25 17:06:38,760 [TB-Scheduling-8] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 17:06:38,761 [TB-Scheduling-8] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 4, failures: 4, exec time: 16
2024-01-25 17:06:40,962 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:06:43,963 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:06:46,963 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:06:49,963 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:06:52,486 [nioEventLoopGroup-4-7] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:06:52,567 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:06:52,568 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:06:52,570 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [8029b8ed-1f1d-4e7b-b399-b9a3f154d534] Failed to process the request: TbProtoQueueMsg(key=ab49ffcb-598f-4701-9fa8-7ef1f6e1323f, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@7507b400)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:06:52,963 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:06:55,963 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:06:58,964 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:07:01,964 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:07:04,964 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:07:07,964 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:07:10,966 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:07:11,391 [nioEventLoopGroup-4-8] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:07:11,424 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:07:11,425 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:07:11,426 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [2a971297-b190-441d-91d0-2a5deaf1ce86] Failed to process the request: TbProtoQueueMsg(key=8cfc6f5c-f5ca-4691-b5b5-7bcd413881a9, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@1897eafe)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:07:13,965 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:07:16,966 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:07:19,966 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:07:20,142 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:07:20,143 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:07:20,145 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [cbe35305-5ceb-4571-996b-963620ea6eba] Failed to process usage stats: TbProtoQueueMsg(key=b11b9de0-a6c4-4d61-81b4-556a3b51ad2a, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@eecd9fc)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 17:07:22,966 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:07:25,967 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:07:28,967 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:07:30,653 [nioEventLoopGroup-4-9] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:07:30,714 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:07:30,715 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:07:30,717 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [c6a77d9c-691a-4a97-820a-9a3c153dde45] Failed to process the request: TbProtoQueueMsg(key=0238b6d7-dce3-4336-8454-6026bffb4c9a, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@47bf5123)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:07:31,967 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:07:34,968 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:07:37,968 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:07:38,745 [TB-Scheduling-4] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [1]
2024-01-25 17:07:38,763 [TB-Scheduling-8] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 17:07:38,764 [TB-Scheduling-8] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 4, failures: 4, exec time: 21 
2024-01-25 17:07:38,765 [TB-Scheduling-8] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 17:07:38,766 [TB-Scheduling-8] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 4, failures: 4, exec time: 21
2024-01-25 17:07:40,969 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:07:43,969 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:07:46,969 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:07:49,461 [nioEventLoopGroup-4-10] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:07:49,529 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:07:49,531 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:07:49,532 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [9161f6c2-36f1-4711-a941-f19522ceae72] Failed to process the request: TbProtoQueueMsg(key=d6e3d293-47b8-474b-bf6a-93b058ae5b33, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@4615aeae)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:07:49,970 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:07:52,970 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:07:55,970 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:07:58,970 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:08:01,970 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:08:04,971 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:08:07,971 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:08:08,947 [nioEventLoopGroup-4-11] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:08:08,989 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:08:08,990 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:08:08,992 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [792876ca-642d-4e60-bf47-148a78048b33] Failed to process the request: TbProtoQueueMsg(key=cf4ff0fd-a394-42ac-8322-0e1884e20d9e, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@43fc737)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:08:10,971 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:08:13,972 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:08:16,972 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:08:19,973 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:08:20,144 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:08:20,145 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:08:20,147 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [c32d7910-8f8f-4ae9-a7f7-b8a1df08a5e3] Failed to process usage stats: TbProtoQueueMsg(key=ac919dec-e25e-4225-8eee-d6adfdd3f253, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@740a3d16)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 17:08:22,972 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:08:25,973 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:08:27,175 [nioEventLoopGroup-4-12] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:08:27,235 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:08:27,236 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:08:27,237 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [c2a5777a-25e2-40be-a114-07b2021aa2d9] Failed to process the request: TbProtoQueueMsg(key=50bdff88-e3c3-4bf9-99ca-7919876bcbc7, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@61352a76)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:08:28,973 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:08:31,973 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:08:34,973 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:08:37,974 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:08:38,748 [TB-Scheduling-6] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [0]
2024-01-25 17:08:38,767 [TB-Scheduling-3] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 17:08:38,768 [TB-Scheduling-3] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 4, failures: 4, exec time: 16 
2024-01-25 17:08:38,769 [TB-Scheduling-3] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 17:08:38,770 [TB-Scheduling-3] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 4, failures: 4, exec time: 16
2024-01-25 17:08:40,974 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:08:43,975 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:08:45,814 [nioEventLoopGroup-4-1] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:08:45,855 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:08:45,856 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:08:45,858 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [cd4340d2-587e-443a-9b8e-a9bde2869173] Failed to process the request: TbProtoQueueMsg(key=4107d84c-912b-4189-90ad-2f87862efc75, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@4fd6677d)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:08:46,975 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:08:49,975 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:08:52,975 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:08:55,975 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:08:58,976 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:09:01,976 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:09:04,250 [nioEventLoopGroup-4-2] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:09:04,308 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:09:04,310 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:09:04,313 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [8e2664d9-2512-4145-971e-303c0657fd08] Failed to process the request: TbProtoQueueMsg(key=06a8f9e2-7cbd-4720-b764-4fd41b129e47, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@7fb02817)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:09:04,977 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:09:07,978 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:09:10,978 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:09:13,978 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:09:16,978 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:09:19,978 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:09:20,149 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:09:20,150 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:09:20,152 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [b6475efe-c435-4663-9fd2-64ed273ab332] Failed to process usage stats: TbProtoQueueMsg(key=d289978b-e645-43ea-af20-e19181326911, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@4ce097c4)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 17:09:22,434 [nioEventLoopGroup-4-3] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:09:22,477 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:09:22,478 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:09:22,479 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [a36151d7-05ed-48e7-8e29-3eed398d0230] Failed to process the request: TbProtoQueueMsg(key=f583de78-d7bf-4b37-a83c-d8f7af14b795, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@576620e0)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:09:22,978 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:09:25,979 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:09:28,979 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:09:31,979 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:09:34,980 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:09:37,980 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:09:38,750 [TB-Scheduling-3] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [0]
2024-01-25 17:09:38,771 [TB-Scheduling-4] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 17:09:38,772 [TB-Scheduling-4] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 4, failures: 4, exec time: 18 
2024-01-25 17:09:38,772 [TB-Scheduling-4] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 17:09:38,773 [TB-Scheduling-4] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 4, failures: 4, exec time: 18
2024-01-25 17:09:40,980 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:09:41,053 [nioEventLoopGroup-4-4] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:09:41,678 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:09:41,680 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:09:41,681 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [528f8e0a-dacf-4000-9e18-f1f26f5d886e] Failed to process the request: TbProtoQueueMsg(key=3a8dec06-f45d-4d42-ac71-dc1ed0968b2a, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@2b4c74f7)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:09:43,980 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:09:46,981 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:09:49,981 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:09:52,981 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:09:55,982 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:09:58,982 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:09:59,925 [nioEventLoopGroup-4-5] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:09:59,957 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:09:59,958 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:09:59,960 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [4cb235d3-42b3-40eb-87c0-831297399d4f] Failed to process the request: TbProtoQueueMsg(key=0848ebb5-80ee-4741-ad09-b861dbb22f7e, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@46cf6b9e)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:10:01,982 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:10:04,982 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:10:07,983 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:10:10,983 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:10:13,984 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:10:16,984 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:10:18,362 [nioEventLoopGroup-4-6] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:10:18,408 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:10:18,410 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:10:18,413 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [bfa04c08-2260-456f-88bf-16b1b77c9c72] Failed to process the request: TbProtoQueueMsg(key=5708e184-7f75-4f70-ac92-cd2e81ac2c47, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@58549ff0)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:10:19,984 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:10:20,150 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:10:20,151 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:10:20,153 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [2b278bf0-f4c3-4b58-b081-1aed0cd70167] Failed to process usage stats: TbProtoQueueMsg(key=536fa7a9-5eb4-4119-867e-aa4056b8b22a, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@4ad57e18)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 17:10:22,984 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:10:25,984 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:10:28,985 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:10:31,985 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:10:34,985 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:10:37,016 [nioEventLoopGroup-4-7] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:10:37,065 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:10:37,066 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:10:37,070 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [1e01ee00-4139-451f-bb63-bb1741a443e2] Failed to process the request: TbProtoQueueMsg(key=b8f5aa28-3841-4570-a56e-29c3fff372b8, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@19991ea8)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:10:37,986 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:10:38,752 [TB-Scheduling-5] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [1]
2024-01-25 17:10:38,774 [TB-Scheduling-8] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 17:10:38,775 [TB-Scheduling-8] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 5, failures: 5, exec time: 21 
2024-01-25 17:10:38,776 [TB-Scheduling-8] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 17:10:38,777 [TB-Scheduling-8] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 5, failures: 5, exec time: 21
2024-01-25 17:10:40,986 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:10:43,986 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:10:46,986 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:10:49,987 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:10:52,987 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:10:55,248 [nioEventLoopGroup-4-8] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:10:55,286 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:10:55,287 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:10:55,288 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [42d26c31-df97-4a5a-ac3d-91cebfe526b6] Failed to process the request: TbProtoQueueMsg(key=a370d41a-3d6f-45d3-954f-b21434a72644, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@1221e879)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:10:55,987 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:10:58,987 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:11:01,987 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:11:04,988 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:11:07,988 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:11:10,988 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:11:13,270 [nioEventLoopGroup-4-9] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:11:13,330 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:11:13,331 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:11:13,332 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [19093f78-52ec-40e2-a52e-7519ad95cb20] Failed to process the request: TbProtoQueueMsg(key=1d191bc5-2d8f-487b-9e75-8c9d445a5860, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@154fba1e)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:11:13,989 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:11:16,989 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:11:19,989 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:11:20,141 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:11:20,142 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:11:20,144 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [678d74c2-aba4-4de4-88b7-410d520767b8] Failed to process usage stats: TbProtoQueueMsg(key=1c0cdb94-11a4-45c3-9044-09ca94b6460b, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@6d3b9011)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 17:11:22,989 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:11:25,990 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:11:28,990 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:11:31,938 [nioEventLoopGroup-4-10] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:11:31,990 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:11:31,999 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:11:32,000 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:11:32,001 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [ed8af93b-5536-406d-8a1e-986380ba982b] Failed to process the request: TbProtoQueueMsg(key=56da6382-d19a-48bd-96ab-ff76089a8abd, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@34b9bfab)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:11:34,991 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:11:37,991 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:11:38,754 [TB-Scheduling-8] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [1]
2024-01-25 17:11:38,779 [TB-Scheduling-4] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 17:11:38,780 [TB-Scheduling-4] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 4, failures: 4, exec time: 14 
2024-01-25 17:11:38,780 [TB-Scheduling-4] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 17:11:38,781 [TB-Scheduling-4] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 4, failures: 4, exec time: 14
2024-01-25 17:11:40,991 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:11:43,991 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:11:46,991 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:11:49,991 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:11:50,688 [nioEventLoopGroup-4-11] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:11:51,888 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:11:51,889 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:11:51,893 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [145b5de5-6974-428d-b512-1587da7f55ab] Failed to process the request: TbProtoQueueMsg(key=263278ef-46c8-4b6a-9ac6-d59446c6304b, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@730fb6b)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:11:52,991 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:11:55,992 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:11:58,992 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:12:01,993 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:12:04,993 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:12:07,994 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:12:09,967 [nioEventLoopGroup-4-12] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:12:10,043 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:12:10,044 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:12:10,046 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [adffe8ae-5189-427f-b767-7ebff2c2eb90] Failed to process the request: TbProtoQueueMsg(key=72ab9578-ad15-4315-b02a-d7e170d58528, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@369a0c52)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:12:10,994 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:12:13,994 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:12:16,994 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:12:19,994 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:12:20,162 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:12:20,163 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:12:20,165 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [fb14957c-534e-4453-9464-ee01b5878ec8] Failed to process usage stats: TbProtoQueueMsg(key=b326d62c-8173-4f7e-9a41-b2b3b678c424, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@7f8e7277)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 17:12:22,995 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:12:25,995 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:12:28,387 [nioEventLoopGroup-4-1] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:12:28,463 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:12:28,464 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:12:28,465 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [521ab95c-dd71-486b-a0d0-dcf23477d15a] Failed to process the request: TbProtoQueueMsg(key=4871a751-ac82-4d64-84d4-38bc242f0d51, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@93890e1)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:12:28,996 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:12:31,996 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:12:34,996 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:12:37,996 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:12:38,755 [TB-Scheduling-3] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [0]
2024-01-25 17:12:38,782 [TB-Scheduling-6] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 17:12:38,784 [TB-Scheduling-6] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 4, failures: 4, exec time: 16 
2024-01-25 17:12:38,784 [TB-Scheduling-6] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 17:12:38,786 [TB-Scheduling-6] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 4, failures: 4, exec time: 16
2024-01-25 17:12:40,997 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:12:43,997 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:12:46,997 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:12:47,442 [nioEventLoopGroup-4-2] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:12:47,479 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:12:47,480 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:12:47,482 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [8de7a3cb-4dd4-4db3-97ca-94b34c031a69] Failed to process the request: TbProtoQueueMsg(key=95e65116-a4a7-44ba-83cd-9fdab883bc95, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@3ffb2b9)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:12:49,997 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:12:52,998 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:12:55,998 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:12:58,998 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:13:01,999 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:13:04,999 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:13:06,230 [nioEventLoopGroup-4-3] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:13:06,302 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:13:06,304 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:13:06,305 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [7db04d45-28b8-4270-8ff7-92573480747f] Failed to process the request: TbProtoQueueMsg(key=02ff2e68-d281-4e46-85f2-ec22c0be5956, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@d34b8ce)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:13:07,999 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:13:10,999 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:13:13,999 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:13:17,000 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:13:20,000 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:13:20,150 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:13:20,151 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:13:20,152 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [82f01a16-2601-4d3f-9c95-a2d6bb1aeb71] Failed to process usage stats: TbProtoQueueMsg(key=43a315ff-64df-490a-8fbc-995086976db5, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@78a7eed2)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 17:13:23,000 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:13:24,622 [nioEventLoopGroup-4-4] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:13:24,659 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:13:24,660 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:13:24,662 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [749f4f0e-3836-4f62-b804-0ebba37f3166] Failed to process the request: TbProtoQueueMsg(key=9c1b707f-fee7-4a9d-8bae-5ffe4965f6f9, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@1a8c2ac5)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:13:26,001 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:13:29,001 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:13:32,002 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:13:35,002 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:13:38,002 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:13:38,756 [TB-Scheduling-7] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [0]
2024-01-25 17:13:38,787 [TB-Scheduling-3] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 17:13:38,788 [TB-Scheduling-3] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 4, failures: 4, exec time: 15 
2024-01-25 17:13:38,789 [TB-Scheduling-3] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 17:13:38,790 [TB-Scheduling-3] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 4, failures: 4, exec time: 15
2024-01-25 17:13:41,002 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:13:43,571 [nioEventLoopGroup-4-5] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:13:43,646 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:13:43,648 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:13:43,649 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [c98461f7-6c1f-4d94-b578-95b31ec14351] Failed to process the request: TbProtoQueueMsg(key=8d718a73-d94c-42d5-829f-b98b8c84891c, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@2796194)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:13:44,002 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:13:47,003 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:13:50,003 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:13:53,003 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:13:56,003 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:13:59,004 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:14:02,005 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:14:02,406 [nioEventLoopGroup-4-6] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:14:02,436 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:14:02,439 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:14:02,442 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [f1b39624-b6fc-43d2-b278-b9322d78a67e] Failed to process the request: TbProtoQueueMsg(key=bf652bf0-2548-414a-b9da-9f9a2e95ae0f, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@533978df)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:14:05,005 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:14:08,005 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:14:11,005 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:14:14,006 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:14:17,006 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:14:20,006 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:14:20,146 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:14:20,147 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:14:20,149 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [e613f2d3-1979-42c2-bb4f-6d393e90a056] Failed to process usage stats: TbProtoQueueMsg(key=e9b02355-a928-49d6-aa08-aab4292ac5f8, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@877cff0)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 17:14:20,955 [nioEventLoopGroup-4-7] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:14:22,111 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:14:22,112 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:14:22,114 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [7f0fdca0-90fb-4bf8-8a47-54aa0a1af680] Failed to process the request: TbProtoQueueMsg(key=8c84ccf0-5e80-489f-a840-96edf727983d, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@5eb82ec4)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:14:23,006 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:14:26,007 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:14:29,007 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:14:32,007 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:14:35,007 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:14:38,008 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:14:38,757 [TB-Scheduling-8] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [1]
2024-01-25 17:14:38,790 [TB-Scheduling-1] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 17:14:38,792 [TB-Scheduling-1] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 4, failures: 4, exec time: 20 
2024-01-25 17:14:38,792 [TB-Scheduling-1] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 17:14:38,793 [TB-Scheduling-1] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 4, failures: 4, exec time: 20
2024-01-25 17:14:39,295 [nioEventLoopGroup-4-8] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:14:39,341 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:14:39,342 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:14:39,344 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [acce5c83-fc22-4a39-b018-9dea04f6c090] Failed to process the request: TbProtoQueueMsg(key=1a961819-fa91-4d16-80f9-079f366c96cd, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@187d423b)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:14:41,008 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:14:44,008 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:14:47,008 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:14:50,009 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:14:53,009 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:14:56,009 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:14:57,417 [nioEventLoopGroup-4-9] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:14:57,466 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:14:57,467 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:14:57,469 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [6031c845-63b4-4511-9bec-acafddcb4864] Failed to process the request: TbProtoQueueMsg(key=d34ea223-3366-4e47-aab5-85c45feea919, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@70ee0a4)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:14:59,009 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:15:02,010 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:15:05,010 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:15:08,010 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:15:11,011 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:15:14,011 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:15:15,940 [nioEventLoopGroup-4-10] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:15:16,004 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:15:16,007 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:15:16,009 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [3283f775-fa58-41c1-b96a-45ba3c53d12a] Failed to process the request: TbProtoQueueMsg(key=ba4bc6b3-5af0-45f7-b7db-69b8c9f1bd43, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@44acb820)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:15:17,011 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:15:20,011 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:15:20,142 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:15:20,143 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:15:20,144 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [e8b3d211-8d25-4496-8651-ff9885fd74e9] Failed to process usage stats: TbProtoQueueMsg(key=6625bafc-03b8-4fcd-85cc-bd45091552df, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@61921475)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 17:15:23,012 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:15:26,012 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:15:29,012 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:15:32,012 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:15:35,012 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:15:35,197 [nioEventLoopGroup-4-11] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:15:35,253 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:15:35,254 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:15:35,256 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [42c44990-3a79-4856-b0dc-d2f981f14ae6] Failed to process the request: TbProtoQueueMsg(key=54df63a2-8130-4c68-beae-79d926dbacc1, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@5113e062)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:15:38,013 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:15:38,759 [TB-Scheduling-6] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [1]
2024-01-25 17:15:38,794 [TB-Scheduling-8] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 17:15:38,794 [TB-Scheduling-8] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 5, failures: 5, exec time: 23 
2024-01-25 17:15:38,795 [TB-Scheduling-8] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 17:15:38,796 [TB-Scheduling-8] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 5, failures: 5, exec time: 23
2024-01-25 17:15:41,013 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:15:44,013 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:15:47,014 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:15:50,014 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:15:53,014 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:15:53,615 [nioEventLoopGroup-4-12] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:15:53,660 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:15:53,662 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:15:53,663 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [2b48df6a-cd3c-4746-a904-5b6d6431ac4d] Failed to process the request: TbProtoQueueMsg(key=c52558a5-3a56-4e98-aa73-ecc4e4c0bc2b, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@11d611b7)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:15:56,014 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:15:59,015 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:16:02,015 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:16:05,015 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:16:08,016 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:16:11,016 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:16:13,052 [nioEventLoopGroup-4-1] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:16:13,117 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:16:13,121 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:16:13,123 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [52f53794-e3e4-432a-901a-638e21b70bab] Failed to process the request: TbProtoQueueMsg(key=c32ccbae-a0b8-4bce-a443-e443a0739d0f, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@679779af)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:16:14,016 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:16:17,016 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:16:20,016 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:16:20,154 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:16:20,157 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:16:20,159 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [d3000ee3-b987-4816-8c42-987b49f6758d] Failed to process usage stats: TbProtoQueueMsg(key=e54aa54b-dc81-4c9b-b83b-e7759789ecc5, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@153dbebe)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 17:16:23,017 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:16:26,017 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:16:29,017 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:16:31,279 [nioEventLoopGroup-4-2] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:16:32,017 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:16:32,276 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:16:32,708 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:16:32,711 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [a5a1128e-e401-48a9-9aa6-3bdb93f80c7a] Failed to process the request: TbProtoQueueMsg(key=78400a2a-4748-4bb8-9714-c29cb9eeda60, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@da0e7f1)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:16:35,018 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:16:38,018 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:16:38,760 [TB-Scheduling-4] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [1]
2024-01-25 17:16:38,797 [TB-Scheduling-7] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 17:16:38,798 [TB-Scheduling-7] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 4, failures: 4, exec time: 451 
2024-01-25 17:16:38,799 [TB-Scheduling-7] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 17:16:38,801 [TB-Scheduling-7] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 4, failures: 4, exec time: 451
2024-01-25 17:16:41,018 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:16:44,009 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:16:47,010 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:16:49,239 [nioEventLoopGroup-4-3] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:16:49,300 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:16:49,301 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:16:49,302 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [cc07f96a-424d-4530-a527-fb7f8a30689d] Failed to process the request: TbProtoQueueMsg(key=8537f63d-c889-4c87-a9b0-5f5f1347b8d0, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@decf526)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:16:50,010 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:16:53,010 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:16:56,010 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:16:59,010 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:17:02,011 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:17:05,011 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:17:07,565 [nioEventLoopGroup-4-4] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:17:07,637 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:17:07,639 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:17:07,640 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [8d98f33c-eb75-4784-98de-315e1c96e770] Failed to process the request: TbProtoQueueMsg(key=46d3bde1-32ce-457b-a881-9a53c9c00613, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@4357606a)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:17:08,011 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:17:11,011 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:17:14,021 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:17:17,021 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:17:20,021 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:17:20,165 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:17:20,167 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:17:20,169 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [99e339a4-ebdd-4735-9be5-64e7fc48840c] Failed to process usage stats: TbProtoQueueMsg(key=c89d4227-d8db-4cb1-9f27-0cecc635ba08, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@5ce8aa9a)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 17:17:23,021 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:17:26,022 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:17:29,022 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:17:32,022 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:17:35,022 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:17:38,022 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:17:38,769 [TB-Scheduling-8] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [0]
2024-01-25 17:17:38,802 [TB-Scheduling-6] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 17:17:38,804 [TB-Scheduling-6] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 3, failures: 3, exec time: 11 
2024-01-25 17:17:38,804 [TB-Scheduling-6] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 17:17:38,805 [TB-Scheduling-6] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 3, failures: 3, exec time: 11
2024-01-25 17:17:41,023 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:17:44,023 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:17:46,975 [nioEventLoopGroup-4-5] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:17:47,023 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:17:47,033 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:17:47,034 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:17:47,035 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [f369e5b2-a358-4f57-97cc-39921f0e375f] Failed to process the request: TbProtoQueueMsg(key=e6332e88-ad6f-48f6-abf1-25f46743ef00, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@24bf9fd4)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:17:50,024 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:17:53,024 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:17:56,024 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:17:59,024 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:18:02,025 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:18:05,025 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:18:05,340 [nioEventLoopGroup-4-6] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:18:05,375 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:18:05,376 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:18:05,377 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [8c28a1f7-bc8d-496d-841b-bf1779661676] Failed to process the request: TbProtoQueueMsg(key=0682b604-d2de-4b8b-819b-5ddb433a96d5, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@2079a485)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:18:08,025 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:18:11,026 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:18:14,025 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:18:17,026 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:18:20,026 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:18:20,164 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:18:20,165 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:18:20,166 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [266e753b-6a7d-49a8-9eb6-5a91da52b40c] Failed to process usage stats: TbProtoQueueMsg(key=49418b4c-7669-439f-95f4-6e6a8db52b36, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@23be5730)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 17:18:23,026 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:18:23,907 [nioEventLoopGroup-4-7] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:18:23,952 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:18:23,953 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:18:23,955 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [b3c22bad-8f31-4b3b-bdcf-08b93087bc41] Failed to process the request: TbProtoQueueMsg(key=316968db-6e48-4b8a-a48a-71b735780ad3, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@18f57fc9)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:18:26,027 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:18:29,027 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:18:32,028 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:18:35,029 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:18:38,028 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:18:38,770 [TB-Scheduling-4] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [0]
2024-01-25 17:18:38,805 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 17:18:38,807 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 4, failures: 4, exec time: 12 
2024-01-25 17:18:38,808 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 17:18:38,809 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 4, failures: 4, exec time: 12
2024-01-25 17:18:41,029 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:18:41,846 [nioEventLoopGroup-4-8] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:18:42,454 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:18:42,455 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:18:42,457 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [7feaed27-8c9d-4d41-a5c3-c7920f92a835] Failed to process the request: TbProtoQueueMsg(key=a2ab274d-8330-41c7-9dba-f616248bf62c, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@7475c0e2)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:18:44,029 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:18:47,029 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:18:50,029 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:18:53,030 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:18:56,030 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:18:59,030 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:18:59,812 [nioEventLoopGroup-4-9] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:18:59,844 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:18:59,845 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:18:59,846 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [4750d918-ca21-457a-8d3d-29fcafe760e9] Failed to process the request: TbProtoQueueMsg(key=042b2669-4214-4c65-9218-c9401e012c47, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@53ec7f30)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:19:02,030 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:19:05,031 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:19:08,031 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:19:11,031 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:19:14,031 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:19:17,031 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:19:17,671 [nioEventLoopGroup-4-10] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:19:17,718 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:19:17,719 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:19:17,720 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [80afe487-a5bd-4280-8cd2-899ab71844ab] Failed to process the request: TbProtoQueueMsg(key=1e02485e-e6b3-4504-a085-c1ca7781b1a2, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@4a87eca5)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:19:20,031 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:19:20,164 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:19:20,165 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:19:20,167 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [d675235d-0668-453c-aa8e-9027f176ac42] Failed to process usage stats: TbProtoQueueMsg(key=2b32b8f8-289e-4bca-a9f9-c09627ddfa8a, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@45ad467b)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 17:19:23,032 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:19:26,032 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:19:29,032 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:19:32,033 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:19:35,033 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:19:36,578 [nioEventLoopGroup-4-11] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:19:36,622 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:19:36,623 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:19:36,625 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [2a895c12-be12-4674-a98a-53c137e20675] Failed to process the request: TbProtoQueueMsg(key=3730234b-0368-4fae-94bf-40995abe4ed9, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@5b24d7f2)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:19:38,033 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:19:38,771 [TB-Scheduling-4] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [1]
2024-01-25 17:19:38,809 [TB-Scheduling-7] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 17:19:38,809 [TB-Scheduling-7] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 5, failures: 5, exec time: 18 
2024-01-25 17:19:38,810 [TB-Scheduling-7] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 17:19:38,811 [TB-Scheduling-7] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 5, failures: 5, exec time: 18
2024-01-25 17:19:41,034 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:19:44,034 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:19:47,034 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:19:50,034 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:19:53,034 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:19:55,215 [nioEventLoopGroup-4-12] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:19:55,271 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:19:55,272 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:19:55,273 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [9d469cbe-2b12-4364-91f6-56afed9cee5c] Failed to process the request: TbProtoQueueMsg(key=38a0161e-3b74-48d1-ab9d-f0c6e5244882, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@3b620da)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:19:56,035 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:19:59,035 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:20:02,035 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:20:05,036 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:20:08,036 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:20:11,036 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:20:14,036 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:20:14,842 [nioEventLoopGroup-4-1] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:20:14,879 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:20:14,881 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:20:14,882 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [71359eb3-8eca-4e47-855d-a93feeea9aab] Failed to process the request: TbProtoQueueMsg(key=9f0e5e7b-c887-4b28-a9de-a3391368f779, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@188ecb19)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:20:17,036 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:20:20,037 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:20:20,166 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:20:20,168 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:20:20,169 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [260c2bfc-f38b-4dff-9760-1f1f0dd03909] Failed to process usage stats: TbProtoQueueMsg(key=cdb2b9b8-56f5-4fa9-aede-3ec80aa8b8be, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@66f2ce7f)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 17:20:23,037 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:20:26,037 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:20:29,037 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:20:32,038 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:20:33,287 [nioEventLoopGroup-4-2] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:20:33,359 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:20:33,361 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:20:33,363 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [e4e1ec74-6aed-4992-9ed3-3b1364d8a1a2] Failed to process the request: TbProtoQueueMsg(key=10639b92-496f-486d-b269-a5309ed9f430, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@368e5825)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:20:35,038 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:20:38,038 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:20:38,772 [TB-Scheduling-4] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [1]
2024-01-25 17:20:38,811 [TB-Scheduling-3] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 17:20:38,813 [TB-Scheduling-3] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 4, failures: 4, exec time: 15 
2024-01-25 17:20:38,813 [TB-Scheduling-3] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 17:20:38,814 [TB-Scheduling-3] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 4, failures: 4, exec time: 15
2024-01-25 17:20:41,039 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:20:44,039 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:20:47,039 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:20:50,039 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:20:52,005 [nioEventLoopGroup-4-3] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:20:52,653 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:20:52,654 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:20:52,656 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [b2920953-f900-4ae9-9445-9bb024dcfdcc] Failed to process the request: TbProtoQueueMsg(key=bb20c51c-3f64-476b-bdd0-260e3b90651c, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@69c531b3)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:20:53,039 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:20:56,040 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:20:59,040 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:21:02,040 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:21:05,040 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:21:08,040 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:21:10,060 [nioEventLoopGroup-4-4] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:21:10,094 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:21:10,094 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:21:10,097 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [9bc176ee-1bae-46f5-91dd-9c85e8dbb88b] Failed to process the request: TbProtoQueueMsg(key=b9fe0336-aa69-4199-90f4-f90a7c36380b, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@7d6846dc)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:21:11,041 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:21:14,041 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:21:17,041 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:21:20,041 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:21:20,169 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:21:20,170 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:21:20,171 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [5810b64a-8276-4995-b162-9cd1b089aa06] Failed to process usage stats: TbProtoQueueMsg(key=d4e11210-bb16-4313-b12a-fdc77a88c13b, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@2f39f6f8)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 17:21:23,042 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:21:26,042 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:21:28,379 [nioEventLoopGroup-4-5] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:21:28,449 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:21:28,450 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:21:28,452 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [987e843a-caca-441f-8985-e88868ab5f9b] Failed to process the request: TbProtoQueueMsg(key=2a345e4a-28ea-4cfa-bc22-7b456a9f032f, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@7d986c81)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:21:29,042 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:21:32,042 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:21:35,043 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:21:38,043 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:21:38,773 [TB-Scheduling-2] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [0]
2024-01-25 17:21:38,814 [TB-Scheduling-6] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 17:21:38,815 [TB-Scheduling-6] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 4, failures: 4, exec time: 14 
2024-01-25 17:21:38,816 [TB-Scheduling-6] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 17:21:38,816 [TB-Scheduling-6] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 4, failures: 4, exec time: 14
2024-01-25 17:21:41,043 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:21:44,044 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:21:47,044 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:21:47,311 [nioEventLoopGroup-4-6] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:21:47,376 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:21:47,377 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:21:47,378 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [91fdcecb-a01e-4786-a1b7-ea078a78a9ad] Failed to process the request: TbProtoQueueMsg(key=fed6643e-1e2e-43eb-919e-b348ee4b6a3f, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@72e01976)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:21:50,045 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:21:53,045 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:21:56,045 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:21:59,045 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:22:02,045 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:22:05,046 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:22:05,872 [nioEventLoopGroup-4-7] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:22:05,924 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:22:05,925 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:22:05,926 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [163dea08-c816-4459-9c44-b8253d896dcb] Failed to process the request: TbProtoQueueMsg(key=6355cd31-e156-4e90-979f-069b066a9a4e, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@2e0530a5)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:22:08,046 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:22:11,046 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:22:14,042 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:22:17,043 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:22:20,043 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:22:20,155 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:22:20,156 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:22:20,159 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [f71ea9c5-a89c-4936-9bd5-29217d6d22de] Failed to process usage stats: TbProtoQueueMsg(key=720dfc44-7e8c-4191-abdd-c4cf064e0e55, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@1fadf1c)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 17:22:23,043 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:22:23,870 [nioEventLoopGroup-4-8] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:22:23,919 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:22:23,920 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:22:23,921 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [60c033b0-404f-4217-b7ff-9a66a283265f] Failed to process the request: TbProtoQueueMsg(key=b4376413-e6a4-463f-9b1c-00e128faa856, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@399c40e4)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:22:26,043 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:22:29,044 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:22:32,044 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:22:35,044 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:22:38,044 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:22:38,771 [TB-Scheduling-1] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [0]
2024-01-25 17:22:38,813 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 17:22:38,815 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 4, failures: 4, exec time: 17 
2024-01-25 17:22:38,815 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 17:22:38,816 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 4, failures: 4, exec time: 17
2024-01-25 17:22:41,045 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:22:41,977 [nioEventLoopGroup-4-9] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:22:42,849 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:22:42,849 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:22:42,851 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [a388b9c8-7bd4-4126-bef6-3b96014bdd3c] Failed to process the request: TbProtoQueueMsg(key=560aaa9a-4faf-4bb7-9dc5-ac563e8c3622, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@47e3e15a)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:22:44,049 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:22:47,049 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:22:50,050 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:22:53,050 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:22:56,050 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:22:59,050 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:23:00,505 [nioEventLoopGroup-4-10] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:23:00,536 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:23:00,537 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:23:00,538 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [96d9761d-5d62-4633-b025-872df015ce85] Failed to process the request: TbProtoQueueMsg(key=0f483a3d-da93-49eb-99ce-6eb251966cf9, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@650a2fdd)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:23:02,050 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:23:05,050 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:23:08,051 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:23:11,051 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:23:14,052 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:23:17,052 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:23:19,468 [nioEventLoopGroup-4-11] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:23:19,543 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:23:19,544 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:23:19,545 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [908ef67b-2a8f-4a56-a88b-f108e3fe0529] Failed to process the request: TbProtoQueueMsg(key=945720e0-f986-4f16-b2d3-ddb275e8da16, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@5ebb6c14)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:23:20,052 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:23:20,167 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:23:20,168 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:23:20,169 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [982139df-29c0-4941-90d8-5e54683f5cdf] Failed to process usage stats: TbProtoQueueMsg(key=bfa66725-1ab1-4117-8a33-104bb67616bb, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@736f05c)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 17:23:23,052 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:23:26,053 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:23:29,053 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:23:32,053 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:23:35,053 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:23:38,054 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:23:38,777 [TB-Scheduling-7] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [0]
2024-01-25 17:23:38,821 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 17:23:38,823 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 4, failures: 4, exec time: 14 
2024-01-25 17:23:38,823 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 17:23:38,824 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 4, failures: 4, exec time: 14
2024-01-25 17:23:40,025 [nioEventLoopGroup-4-12] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:23:40,075 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:23:40,076 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:23:40,077 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [e837f145-8835-43a5-880b-a3a59f2de904] Failed to process the request: TbProtoQueueMsg(key=b667bf00-7902-4add-b6b2-c2684cb521ef, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@5fc45d91)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:23:41,054 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:23:44,054 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:23:47,056 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:23:50,055 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:23:53,055 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:23:56,056 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:23:58,401 [nioEventLoopGroup-4-1] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:23:58,455 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:23:58,457 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:23:58,458 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [a92d3db6-ff9a-435f-a7bf-feb54b87588c] Failed to process the request: TbProtoQueueMsg(key=9644b2ab-5949-4957-be49-edc00557f5bb, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@351c4bd2)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:23:59,056 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:24:02,057 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:24:05,057 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:24:08,057 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:24:11,057 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:24:14,058 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:24:17,058 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:24:17,635 [nioEventLoopGroup-4-2] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:24:17,689 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:24:17,690 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:24:17,692 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [5c44a9c0-3a5a-40ee-88b5-22bf24b5a54a] Failed to process the request: TbProtoQueueMsg(key=ff6dc50e-9137-46ad-8d7a-cfac3507c01e, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@368a765a)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:24:20,059 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:24:20,162 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:24:20,163 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:24:20,165 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [2c080052-d5c1-4986-aa31-8bf107352fa1] Failed to process usage stats: TbProtoQueueMsg(key=dd4c413f-1535-4cc6-bf4e-5ef101f392fe, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@71212456)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 17:24:23,059 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:24:26,059 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:24:29,059 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:24:32,060 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:24:35,060 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:24:36,282 [nioEventLoopGroup-4-3] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:24:36,356 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:24:36,358 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:24:36,359 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [3a7c5ae1-514b-4214-ac4c-519940c9f0a0] Failed to process the request: TbProtoQueueMsg(key=6b60781a-8c19-4cfe-ade6-87148fbd1705, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@6452a58c)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:24:38,060 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:24:38,779 [TB-Scheduling-8] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [1]
2024-01-25 17:24:38,825 [TB-Scheduling-5] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 17:24:38,826 [TB-Scheduling-5] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 5, failures: 5, exec time: 19 
2024-01-25 17:24:38,826 [TB-Scheduling-5] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 17:24:38,827 [TB-Scheduling-5] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 5, failures: 5, exec time: 19
2024-01-25 17:24:41,060 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:24:44,060 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:24:47,061 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:24:50,061 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:24:53,061 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:24:54,788 [nioEventLoopGroup-4-4] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:24:54,847 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:24:54,848 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:24:54,848 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [ea8b2f35-943e-4874-80d0-c23701cec8fb] Failed to process the request: TbProtoQueueMsg(key=2294b8bc-1884-46dc-977e-c47f62d29334, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@76941e00)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:24:56,062 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:24:59,062 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:25:02,062 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:25:05,063 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:25:08,063 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:25:11,063 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:25:12,896 [nioEventLoopGroup-4-5] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:25:13,094 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:25:13,095 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:25:13,097 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [cc9ef8fc-41aa-48f4-a511-73b5d5019d24] Failed to process the request: TbProtoQueueMsg(key=a4feae2f-4dd2-4a73-a696-4ad6f151511b, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@19d69cfb)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:25:14,063 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:25:17,063 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:25:20,064 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:25:20,178 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:25:20,180 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:25:20,181 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [7736bfda-d5fa-44c1-83c2-dcd11602116b] Failed to process usage stats: TbProtoQueueMsg(key=49793c10-f412-462f-9a2f-865b97c80ada, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@fe49c86)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 17:25:23,064 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:25:26,064 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:25:29,064 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:25:31,233 [nioEventLoopGroup-4-6] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:25:31,277 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:25:31,278 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:25:31,280 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [383ff39c-8dde-499c-b8e7-60d9aee6f6af] Failed to process the request: TbProtoQueueMsg(key=d8a57f99-54d6-40d7-82f8-7aff686b822f, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@10661a2a)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:25:32,065 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:25:35,065 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:25:38,065 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:25:38,780 [TB-Scheduling-1] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [1]
2024-01-25 17:25:38,828 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 17:25:38,829 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 4, failures: 4, exec time: 18 
2024-01-25 17:25:38,829 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 17:25:38,830 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 4, failures: 4, exec time: 18
2024-01-25 17:25:41,066 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:25:44,066 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:25:47,066 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:25:49,406 [nioEventLoopGroup-4-7] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:25:49,476 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:25:49,477 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:25:49,478 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [84462db5-8c04-45de-be77-944079f49f5c] Failed to process the request: TbProtoQueueMsg(key=c4a8747b-aa6e-4f87-9d14-e347ac902540, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@59367fd3)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:25:50,066 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:25:53,067 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:25:56,067 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:25:59,068 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:26:02,068 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:26:05,068 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:26:08,068 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:26:08,214 [nioEventLoopGroup-4-8] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:26:08,279 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:26:08,280 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:26:08,281 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [73cf968e-3201-46ca-b680-0aaa7e50d703] Failed to process the request: TbProtoQueueMsg(key=8238e52f-3769-4a28-94cc-889fc376289a, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@62405b19)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:26:11,068 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:26:14,069 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:26:17,069 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:26:20,070 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:26:20,168 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:26:20,170 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:26:20,173 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [89f7d215-f316-4d90-b5e7-d6d5e0fe4f1c] Failed to process usage stats: TbProtoQueueMsg(key=01221815-1883-40fb-a367-43ea4d828d2d, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@5f72f55b)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 17:26:23,070 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:26:26,070 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:26:26,420 [nioEventLoopGroup-4-9] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:26:26,474 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:26:26,475 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:26:26,476 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [f639dc04-da70-4e90-95c0-0035b84b73fb] Failed to process the request: TbProtoQueueMsg(key=78b2fea8-2797-4c87-8279-ba6b60fb867b, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@49412f70)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:26:29,071 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:26:32,071 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:26:35,071 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:26:38,071 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:26:38,782 [TB-Scheduling-3] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [0]
2024-01-25 17:26:38,831 [TB-Scheduling-8] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 17:26:38,833 [TB-Scheduling-8] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 4, failures: 4, exec time: 16 
2024-01-25 17:26:38,833 [TB-Scheduling-8] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 17:26:38,834 [TB-Scheduling-8] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 4, failures: 4, exec time: 16
2024-01-25 17:26:41,071 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:26:44,072 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:26:45,068 [nioEventLoopGroup-4-10] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:26:45,145 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:26:45,147 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:26:45,150 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [7f7d0080-97f1-4cce-a99a-b191240625a6] Failed to process the request: TbProtoQueueMsg(key=b156c067-c88d-47de-8539-3c4ab2241371, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@230d475e)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:26:47,072 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:26:50,072 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:26:53,073 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:26:56,073 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:26:59,073 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:27:02,074 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:27:02,953 [nioEventLoopGroup-4-11] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:27:03,291 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:27:03,292 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:27:03,294 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [3f194e8d-a162-4753-9d32-32812f86f00d] Failed to process the request: TbProtoQueueMsg(key=f87f4821-830f-40a1-8997-e96476a81d1b, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@2b25a490)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:27:05,074 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:27:08,074 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:27:11,075 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:27:14,075 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:27:17,075 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:27:20,076 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:27:20,164 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:27:20,165 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:27:20,167 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [00b017fb-a4df-47d4-8139-d382e3153268] Failed to process usage stats: TbProtoQueueMsg(key=f48cafbf-4cf5-458b-afa1-f19b28c92843, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@50f26abd)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 17:27:21,335 [nioEventLoopGroup-4-12] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:27:21,385 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:27:21,385 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:27:21,386 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [3afdb9c6-c2d7-4adb-9e83-2282f36c0798] Failed to process the request: TbProtoQueueMsg(key=9000e69a-35d6-430b-8db1-f49505307432, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@390743d1)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:27:23,076 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:27:26,076 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:27:29,077 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:27:32,077 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:27:35,077 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:27:38,077 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:27:38,783 [TB-Scheduling-2] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [0]
2024-01-25 17:27:38,835 [TB-Scheduling-7] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 17:27:38,836 [TB-Scheduling-7] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 4, failures: 4, exec time: 17 
2024-01-25 17:27:38,837 [TB-Scheduling-7] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 17:27:38,838 [TB-Scheduling-7] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 4, failures: 4, exec time: 17
2024-01-25 17:27:39,989 [nioEventLoopGroup-4-1] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:27:40,041 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:27:40,042 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:27:40,044 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [1383f606-543c-466f-beec-d86f636452b3] Failed to process the request: TbProtoQueueMsg(key=9827430d-d596-4ffc-8ebf-74b8e8df4c67, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@e7fca37)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:27:41,078 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:27:44,078 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:27:47,078 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:27:50,079 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:27:53,079 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:27:56,080 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:27:58,203 [nioEventLoopGroup-4-2] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:27:58,265 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:27:58,267 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:27:58,268 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [1a926d46-a174-4aa5-91ba-7a362a61d45e] Failed to process the request: TbProtoQueueMsg(key=fec11663-4e86-4d3e-92f8-f8a713dad506, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@729b326d)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:27:59,080 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:28:02,080 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:28:05,081 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:28:08,081 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:28:11,081 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:28:14,081 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:28:17,005 [nioEventLoopGroup-4-3] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:28:17,034 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:28:17,034 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:28:17,039 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [12ce28da-86cb-4e6d-96bc-f6ed7d4e24d8] Failed to process the request: TbProtoQueueMsg(key=991bd45d-81ce-4d65-8b97-5e7517a90bf9, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@ce88538)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:28:17,081 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:28:20,082 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:28:20,169 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:28:20,171 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:28:20,174 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [486bafb4-8ee9-4d48-aa4d-e2e08cb99423] Failed to process usage stats: TbProtoQueueMsg(key=53faf212-0c5a-4606-bd4a-7ba3da74542d, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@43c2de86)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 17:28:23,082 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:28:26,082 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:28:29,083 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:28:32,083 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:28:35,083 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:28:35,246 [nioEventLoopGroup-4-4] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:28:35,303 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:28:35,304 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:28:35,308 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [bc17bf18-0b44-4f88-95a3-7079b86df967] Failed to process the request: TbProtoQueueMsg(key=f6a3edfb-8323-40d1-b822-a473ca37154f, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@7b85fa27)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:28:38,083 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:28:38,786 [TB-Scheduling-8] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [1]
2024-01-25 17:28:38,839 [TB-Scheduling-4] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 17:28:38,839 [TB-Scheduling-4] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 5, failures: 5, exec time: 26 
2024-01-25 17:28:38,841 [TB-Scheduling-4] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 17:28:38,844 [TB-Scheduling-4] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 5, failures: 5, exec time: 26
2024-01-25 17:28:41,083 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:28:44,083 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:28:47,083 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:28:50,084 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:28:53,084 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:28:53,833 [nioEventLoopGroup-4-5] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:28:53,872 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:28:53,872 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:28:53,873 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [7f26faf9-8df8-4088-81ef-a7159b872fc8] Failed to process the request: TbProtoQueueMsg(key=53c1f952-c110-4136-995f-1e05126fa754, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@61e07a0a)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:28:56,084 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:28:59,085 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:29:02,085 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:29:05,085 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:29:08,085 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:29:11,086 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:29:11,858 [nioEventLoopGroup-4-6] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:29:13,506 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:29:13,507 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:29:13,509 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [9277a71e-9d74-463d-9a2c-8bcc391fb348] Failed to process the request: TbProtoQueueMsg(key=23e48d6c-2581-4c9b-bec1-4f8bc7ac2d2d, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@7d5316fb)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:29:14,086 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:29:17,086 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:29:20,086 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:29:20,189 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:29:20,190 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:29:20,193 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [754905b1-de6d-4999-9a0b-6685e388ad3d] Failed to process usage stats: TbProtoQueueMsg(key=c9d40cdf-422a-47a3-8bcb-dfe735b35e20, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@21d59ccc)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 17:29:23,086 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:29:26,087 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:29:29,087 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:29:30,164 [nioEventLoopGroup-4-7] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:29:30,225 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:29:30,227 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:29:30,229 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [4f8c1d09-08ce-43db-9e26-6451848b27b2] Failed to process the request: TbProtoQueueMsg(key=5f9ff839-f90b-40c6-8cfd-56db3e2582b8, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@623cdf86)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:29:32,087 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:29:35,088 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:29:38,088 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:29:38,786 [TB-Scheduling-8] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [1]
2024-01-25 17:29:38,845 [TB-Scheduling-4] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 17:29:38,847 [TB-Scheduling-4] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 4, failures: 4, exec time: 15 
2024-01-25 17:29:38,847 [TB-Scheduling-4] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 17:29:38,848 [TB-Scheduling-4] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 4, failures: 4, exec time: 15
2024-01-25 17:29:41,088 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:29:44,084 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:29:47,084 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:29:48,194 [nioEventLoopGroup-4-8] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:29:48,254 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:29:48,255 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:29:48,257 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [9171b353-dc4e-4d9c-a49e-6dfabc05e34d] Failed to process the request: TbProtoQueueMsg(key=31616327-6f8d-420a-aa08-1779aa0b2d44, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@1511000b)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:29:50,084 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:29:53,084 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:29:56,085 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:29:59,085 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:30:02,085 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:30:05,085 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:30:06,145 [nioEventLoopGroup-4-9] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:30:06,195 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:30:06,196 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:30:06,198 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [c74870ab-ae24-434b-a81a-25f76d5b585f] Failed to process the request: TbProtoQueueMsg(key=7278e497-a91a-4162-b702-ffb968fd1a24, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@6eafdc27)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:30:08,085 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:30:11,086 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:30:14,091 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:30:17,091 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:30:20,091 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:30:20,177 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:30:20,178 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:30:20,180 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [92243b76-c28d-4131-91d3-b0951b8018a1] Failed to process usage stats: TbProtoQueueMsg(key=6ff18f01-1fbf-4352-8fea-2fab424cfbfe, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@7f729892)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 17:30:23,091 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:30:24,038 [nioEventLoopGroup-4-10] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:30:24,108 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:30:24,109 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:30:24,111 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [377ebc99-77cb-4e50-84ec-2ef6957e19e6] Failed to process the request: TbProtoQueueMsg(key=b8372cab-67e9-4173-9023-5b760b71986d, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@4a4cc827)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:30:26,091 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:30:29,091 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:30:32,092 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:30:35,092 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:30:38,092 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:30:38,787 [TB-Scheduling-8] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [0]
2024-01-25 17:30:38,849 [TB-Scheduling-6] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 17:30:38,850 [TB-Scheduling-6] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 4, failures: 4, exec time: 14 
2024-01-25 17:30:38,851 [TB-Scheduling-6] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 17:30:38,852 [TB-Scheduling-6] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 4, failures: 4, exec time: 14
2024-01-25 17:30:41,092 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:30:41,958 [nioEventLoopGroup-4-11] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:30:43,591 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:30:43,591 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:30:43,593 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [b23decd2-9373-424d-9372-61812224549a] Failed to process the request: TbProtoQueueMsg(key=a661afbd-8154-437a-9c30-4c7d67e80394, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@7a756185)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:30:44,093 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:30:47,093 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:30:50,093 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:30:53,093 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:30:56,094 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:30:59,094 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:30:59,840 [nioEventLoopGroup-4-12] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:30:59,903 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:30:59,904 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:30:59,905 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [75be20aa-be3f-4bac-9683-fca7052334fc] Failed to process the request: TbProtoQueueMsg(key=8b381a2a-34fd-462d-9c0e-ffe7ab587c0f, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@72121daa)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:31:02,094 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:31:05,094 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:31:08,094 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:31:11,095 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:31:14,095 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:31:17,095 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:31:17,712 [nioEventLoopGroup-4-1] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:31:17,754 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:31:17,755 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:31:17,756 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [c3320a43-1361-46b5-a65d-112a13a6d900] Failed to process the request: TbProtoQueueMsg(key=8b03f542-fc4d-4f40-826c-345c6fac9f89, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@5c70eef1)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:31:20,095 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:31:20,191 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:31:20,192 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:31:20,194 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [a04a5735-5481-4f06-ac2b-1bb1c763bd39] Failed to process usage stats: TbProtoQueueMsg(key=07126193-6630-4d0c-be24-660039769798, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@3be70f83)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 17:31:23,096 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:31:26,096 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:31:29,096 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:31:32,096 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:31:35,096 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:31:36,309 [nioEventLoopGroup-4-2] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:31:36,356 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:31:36,356 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:31:36,358 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [d62f0397-d057-43a3-be6e-216ad65c96dc] Failed to process the request: TbProtoQueueMsg(key=26ea1134-62b5-4ee7-b8bc-92663bb46ac2, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@390cd4a1)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:31:38,096 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:31:38,806 [TB-Scheduling-7] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [1]
2024-01-25 17:31:38,854 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 17:31:38,854 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 5, failures: 5, exec time: 19 
2024-01-25 17:31:38,854 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 17:31:38,855 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 5, failures: 5, exec time: 19
2024-01-25 17:31:41,097 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:31:44,097 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:31:47,097 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:31:50,097 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:31:53,098 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:31:54,920 [nioEventLoopGroup-4-3] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:31:54,985 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:31:54,986 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:31:54,987 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [0b1d1e33-056a-4b00-bbb0-455f70dc59a5] Failed to process the request: TbProtoQueueMsg(key=276eac74-2467-4ab0-b48e-135596b7cb36, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@1d41a18a)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:31:56,098 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:31:59,098 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:32:02,098 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:32:05,098 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:32:08,099 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:32:11,099 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:32:13,027 [nioEventLoopGroup-4-4] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:32:13,640 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:32:13,641 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:32:13,643 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [9f85cea1-0f73-47d5-92ca-edfe8771d5c6] Failed to process the request: TbProtoQueueMsg(key=452cf313-df31-4c24-a01e-750b2d92efdd, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@3c9e6e0c)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:32:14,099 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:32:17,099 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:32:20,100 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:32:20,171 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:32:20,172 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:32:20,173 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [6e9a2a2b-fe06-4d11-a4a7-5c249afebcaa] Failed to process usage stats: TbProtoQueueMsg(key=4e2a6061-31fb-494f-b383-99cbc937df23, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@364b97a5)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 17:32:23,101 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:32:26,101 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:32:29,101 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:32:31,019 [nioEventLoopGroup-4-5] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:32:31,049 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:32:31,050 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:32:31,051 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [fa1007e8-b03d-45b5-84b5-ec94806711a1] Failed to process the request: TbProtoQueueMsg(key=28e97fbb-efd0-4df7-8e96-7525546373bb, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@71abf52b)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:32:32,101 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:32:35,101 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:32:38,101 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:32:38,806 [TB-Scheduling-4] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [1]
2024-01-25 17:32:38,856 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 17:32:38,857 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 4, failures: 4, exec time: 14 
2024-01-25 17:32:38,857 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 17:32:38,858 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 4, failures: 4, exec time: 14
2024-01-25 17:32:41,102 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:32:44,096 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:32:47,097 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:32:49,209 [nioEventLoopGroup-4-6] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:32:49,243 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:32:49,244 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:32:49,245 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [ade25e2b-1eba-4074-9325-52f3e0216630] Failed to process the request: TbProtoQueueMsg(key=c73bc136-c829-4b2d-bea4-0d65324183f3, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@4fb53458)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:32:50,097 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:32:53,097 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:32:56,097 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:32:59,098 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:33:02,098 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:33:05,098 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:33:07,720 [nioEventLoopGroup-4-7] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:33:07,795 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:33:07,799 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:33:07,801 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [4a5ff9bf-89b0-49fd-88ed-286d5875a85d] Failed to process the request: TbProtoQueueMsg(key=cba37efb-006d-4e4b-883c-ead607ce2d68, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@277729b1)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:33:08,098 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:33:11,099 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:33:14,098 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:33:17,098 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:33:20,099 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:33:20,183 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:33:20,184 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:33:20,186 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [0dd6a40c-b489-49cb-8c9b-843b60e16886] Failed to process usage stats: TbProtoQueueMsg(key=666111dd-aa2b-4040-87b3-a8c07c214bfe, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@544fc40e)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 17:33:23,099 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:33:26,099 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:33:26,282 [nioEventLoopGroup-4-8] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:33:26,340 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:33:26,341 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:33:26,344 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [a3adfc67-3c6c-4e4d-b164-2af5522d423d] Failed to process the request: TbProtoQueueMsg(key=29fbccb3-d607-4a87-9a68-01c530075f94, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@4a1f5c96)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:33:29,099 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:33:32,099 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:33:35,100 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:33:38,100 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:33:38,801 [TB-Scheduling-1] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [0]
2024-01-25 17:33:38,853 [TB-Scheduling-6] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 17:33:38,854 [TB-Scheduling-6] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 4, failures: 4, exec time: 16 
2024-01-25 17:33:38,854 [TB-Scheduling-6] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 17:33:38,855 [TB-Scheduling-6] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 4, failures: 4, exec time: 16
2024-01-25 17:33:41,100 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:33:44,100 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:33:45,216 [nioEventLoopGroup-4-9] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:33:45,277 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:33:45,278 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:33:45,280 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [a32f2af1-2a4d-4d16-a9ec-e91a19ad4a0f] Failed to process the request: TbProtoQueueMsg(key=72e1c240-d399-407f-8c90-a8ced66cda44, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@578b716d)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:33:47,100 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:33:50,100 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:33:53,100 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:33:56,101 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:33:59,101 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:34:02,101 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:34:03,721 [nioEventLoopGroup-4-10] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:34:03,796 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:34:03,797 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:34:03,800 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [be0f9dfb-93dc-4487-9280-b28c4a3d02d1] Failed to process the request: TbProtoQueueMsg(key=f0b63b03-f9cf-4988-a615-a9f5557a225a, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@21692f21)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:34:05,101 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:34:08,101 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:34:11,102 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:34:14,102 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:34:17,102 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:34:20,103 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:34:20,171 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:34:20,172 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:34:20,174 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [cbfb48bc-228f-4264-bf05-12b852007898] Failed to process usage stats: TbProtoQueueMsg(key=b5052dc9-d1e6-4d1c-a63f-1d3a1b001414, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@5f341de7)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 17:34:22,391 [nioEventLoopGroup-4-11] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:34:23,103 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:34:23,784 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:34:23,785 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:34:23,787 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [67ca4f7d-5b46-4a8b-8d2c-cfa6a3b004c7] Failed to process the request: TbProtoQueueMsg(key=7bae140d-e625-474e-a414-9893d4e34567, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@1aabb854)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:34:26,103 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:34:29,104 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:34:32,104 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:34:35,104 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:34:38,104 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:34:38,802 [TB-Scheduling-3] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [0]
2024-01-25 17:34:38,855 [TB-Scheduling-1] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 17:34:38,856 [TB-Scheduling-1] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 4, failures: 4, exec time: 16 
2024-01-25 17:34:38,857 [TB-Scheduling-1] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 17:34:38,858 [TB-Scheduling-1] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 4, failures: 4, exec time: 16
2024-01-25 17:34:41,104 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:34:41,357 [nioEventLoopGroup-4-12] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:34:41,402 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:34:41,403 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:34:41,404 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [0291d6f9-2f42-43b5-9af0-deca18e1538c] Failed to process the request: TbProtoQueueMsg(key=613a1cbe-f811-4fb6-813c-deba36916502, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@d1fe141)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:34:44,103 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:34:47,103 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:34:50,103 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:34:53,103 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:34:56,104 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:34:59,104 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:34:59,871 [nioEventLoopGroup-4-1] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:34:59,932 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:34:59,933 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:34:59,934 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [63dd5ca8-aaea-4130-8829-950b65bfc432] Failed to process the request: TbProtoQueueMsg(key=e4a8d5e4-d6a7-46c7-96b3-175cee98dc47, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@5a8522bf)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:35:02,104 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:35:05,104 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:35:08,105 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:35:11,105 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:35:14,105 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:35:17,105 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:35:18,395 [nioEventLoopGroup-4-2] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:35:18,469 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:35:18,470 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:35:18,470 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [818d9480-f38b-40ac-bf75-fa6bd1f13a12] Failed to process the request: TbProtoQueueMsg(key=10e81be1-5857-4215-bd1b-2a3f5d97fbd7, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@2e4e41db)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:35:20,105 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:35:20,185 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:35:20,186 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:35:20,187 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [f846cd0d-90c1-4c86-b9c1-d78d4c8b0fa3] Failed to process usage stats: TbProtoQueueMsg(key=38bd82be-483d-4785-b649-1fe7d122e79d, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@53717183)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 17:35:23,106 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:35:26,106 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:35:29,107 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:35:32,107 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:35:35,107 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:35:36,932 [nioEventLoopGroup-4-3] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:35:36,991 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:35:36,992 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:35:36,995 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [f96c80dd-22ba-4cf7-a53b-47d6091e1fbe] Failed to process the request: TbProtoQueueMsg(key=16e1b959-5093-4bca-a305-299a2b21c92f, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@498161aa)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:35:38,107 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:35:38,801 [TB-Scheduling-7] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [1]
2024-01-25 17:35:38,857 [TB-Scheduling-5] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 17:35:38,857 [TB-Scheduling-5] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 5, failures: 5, exec time: 18 
2024-01-25 17:35:38,858 [TB-Scheduling-5] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 17:35:38,860 [TB-Scheduling-5] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 5, failures: 5, exec time: 18
2024-01-25 17:35:41,107 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:35:44,107 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:35:47,108 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:35:50,108 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:35:53,108 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:35:54,988 [nioEventLoopGroup-4-4] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:35:55,058 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:35:55,059 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:35:55,059 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [dd5707de-6a7c-4c15-a564-3918ab5ee8fe] Failed to process the request: TbProtoQueueMsg(key=31cbc151-84b3-4a95-b596-3f664c322e85, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@1a94f7bc)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:35:56,109 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:35:59,109 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:36:02,109 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:36:05,109 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:36:08,109 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:36:11,110 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:36:12,997 [nioEventLoopGroup-4-5] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:36:13,985 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:36:13,986 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:36:13,990 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [49c24630-af58-4d78-b349-f62cabf86e44] Failed to process the request: TbProtoQueueMsg(key=7eb2df6a-b39a-47c9-a41a-12f429f7065b, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@32080470)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:36:14,109 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:36:17,110 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:36:20,110 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:36:20,188 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:36:20,189 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:36:20,192 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [b7571834-4648-4142-9db2-2909309b2fe5] Failed to process usage stats: TbProtoQueueMsg(key=dbd858c6-9801-4f86-9f9a-94db67c8c99e, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@62a4db61)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 17:36:23,110 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:36:26,110 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:36:29,110 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:36:31,016 [nioEventLoopGroup-4-6] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:36:31,069 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:36:31,070 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:36:31,072 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [ebdc51c0-5542-49c5-b2ce-c8c66862b2c2] Failed to process the request: TbProtoQueueMsg(key=e1252170-b8b9-4be9-8533-6602d6c1d95e, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@2c99e212)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:36:32,111 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:36:35,111 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:36:38,111 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:36:38,801 [TB-Scheduling-7] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [1]
2024-01-25 17:36:38,860 [TB-Scheduling-4] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 17:36:38,862 [TB-Scheduling-4] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 4, failures: 4, exec time: 19 
2024-01-25 17:36:38,862 [TB-Scheduling-4] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 17:36:38,864 [TB-Scheduling-4] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 4, failures: 4, exec time: 19
2024-01-25 17:36:41,111 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:36:44,112 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:36:47,112 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:36:50,112 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:36:52,946 [nioEventLoopGroup-4-7] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:36:53,017 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:36:53,018 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:36:53,020 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [de0e7809-acdb-4530-a2f4-eafa3b525a0f] Failed to process the request: TbProtoQueueMsg(key=432555cb-8fca-4758-a0ec-d0c93ad2785a, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@f818c89)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:36:53,113 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:36:56,113 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:36:59,113 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:37:02,114 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:37:05,114 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:37:08,114 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:37:11,114 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:37:11,150 [nioEventLoopGroup-4-8] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:37:11,202 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:37:11,203 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:37:11,205 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [c37f4c45-9950-4823-8621-4142a5c4fc77] Failed to process the request: TbProtoQueueMsg(key=25a91701-e982-4b49-97d5-96f36d8f9a0d, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@36da69c3)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:37:14,115 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:37:17,115 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:37:20,115 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:37:20,170 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:37:20,171 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:37:20,172 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [02bc8ec3-9f93-42f2-beee-893e826e104d] Failed to process usage stats: TbProtoQueueMsg(key=eccbbc6e-0d2b-4ccd-9d40-579ed9902b1f, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@7dc0f948)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 17:37:23,115 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:37:26,116 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:37:29,116 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:37:29,177 [nioEventLoopGroup-4-9] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:37:29,226 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:37:29,226 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:37:29,229 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [e5ad8a0e-0e03-48d6-a8c9-1b3ba497a34b] Failed to process the request: TbProtoQueueMsg(key=207483b6-d80d-4c75-a698-2663026e415f, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@12b4d98e)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:37:32,116 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:37:35,116 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:37:38,116 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:37:38,802 [TB-Scheduling-5] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [1]
2024-01-25 17:37:38,865 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 17:37:38,866 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 4, failures: 4, exec time: 17 
2024-01-25 17:37:38,867 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 17:37:38,868 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 4, failures: 4, exec time: 17
2024-01-25 17:37:41,117 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:37:44,109 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:37:47,110 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:37:47,394 [nioEventLoopGroup-4-10] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:37:47,428 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:37:47,429 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:37:47,430 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [0299e940-792c-4a43-9347-698ecce220b0] Failed to process the request: TbProtoQueueMsg(key=a2c83515-b87a-4226-8e5c-6700d982d56f, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@236533ea)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:37:50,110 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:37:53,110 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:37:56,110 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:37:59,110 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:38:02,111 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:38:05,111 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:38:06,054 [nioEventLoopGroup-4-11] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:38:06,133 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:38:06,134 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:38:06,134 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [60a1873f-9897-468b-8c47-92099867ac76] Failed to process the request: TbProtoQueueMsg(key=73b27fac-9342-4df8-80d5-7e3cae0497c4, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@d98b8c9)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:38:08,111 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:38:11,111 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:38:14,118 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:38:17,119 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:38:20,119 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:38:20,180 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:38:20,182 [tb-core-usage-stats-consumer-41-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:38:20,182 [tb-core-usage-stats-consumer-41-thread-1] WARN  o.t.s.s.q.DefaultTbCoreConsumerService - [1203e837-cf55-4a50-b491-91a8c7446659] Failed to process usage stats: TbProtoQueueMsg(key=d6d94578-5583-4b72-a446-dedd52ab62cb, value=tenantIdMSB: 1340630062826525166
tenantIdLSB: -7384729617233221057
values {
  key: "ACTIVE_DEVICES"
}
values {
  key: "INACTIVE_DEVICES"
  value: 1
}
serviceId: "138a9a50b9a6"
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@5dd71243)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.processEntityUsageStats(DefaultTbApiUsageStateService.java:182)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.process(DefaultTbApiUsageStateService.java:169)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.handleUsageStats(DefaultTbCoreConsumerService.java:513)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$8(DefaultTbCoreConsumerService.java:441)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1603)
	at org.thingsboard.server.service.queue.DefaultTbCoreConsumerService.lambda$launchUsageStatsConsumer$11(DefaultTbCoreConsumerService.java:437)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 41 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 79 common frames omitted
2024-01-25 17:38:23,119 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:38:24,069 [nioEventLoopGroup-4-12] WARN  o.t.s.t.mqtt.MqttTransportHandler - peer not authenticated
2024-01-25 17:38:24,141 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2024-01-25 17:38:24,143 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
2024-01-25 17:38:24,144 [tb-queue-response-template-loop-tb_transport.api.requests-44-thread-1] WARN  o.t.s.q.c.DefaultTbQueueResponseTemplate - [89bf082e-c0f8-460c-b8c2-3d583172639f] Failed to process the request: TbProtoQueueMsg(key=dc05f86d-88b3-4e21-8489-296df8f55a67, value=entityProfileRequestMsg {
  entityType: "TENANT"
  entityIdMSB: 1340630062826525166
  entityIdLSB: -7384729617233221057
}
, headers=org.thingsboard.server.queue.common.DefaultTbQueueMsgHeaders@1b4bc6d8)
org.springframework.dao.InvalidDataAccessResourceUsageException: could not extract ResultSet; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:259)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy327.findByEntityIdAndEntityType(Unknown Source)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao.findApiUsageStateByEntityId(JpaApiUsageStateDao.java:62)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$FastClassBySpringCGLIB$$f4255317.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at org.thingsboard.server.dao.aspect.SqlDaoCallsAspect.handleSqlCall(SqlDaoCallsAspect.java:162)
	at jdk.internal.reflect.GeneratedMethodAccessor76.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.thingsboard.server.dao.sql.usagerecord.JpaApiUsageStateDao$$EnhancerBySpringCGLIB$$517719f1.findApiUsageStateByEntityId(<generated>)
	at org.thingsboard.server.dao.usagerecord.ApiUsageStateServiceImpl.findApiUsageStateByEntityId(ApiUsageStateServiceImpl.java:159)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getOrFetchState(DefaultTbApiUsageStateService.java:445)
	at org.thingsboard.server.service.apiusage.DefaultTbApiUsageStateService.getApiUsageState(DefaultTbApiUsageStateService.java:232)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:477)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:200)
	at org.thingsboard.server.service.transport.DefaultTransportApiService.handle(DefaultTransportApiService.java:130)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$2(DefaultTbQueueResponseTemplate.java:117)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.thingsboard.server.queue.common.DefaultTbQueueResponseTemplate.lambda$init$3(DefaultTbQueueResponseTemplate.java:98)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:103)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:67)
	at org.hibernate.loader.Loader.getResultSet(Loader.java:2322)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2075)
	at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:2037)
	at org.hibernate.loader.Loader.doQuery(Loader.java:956)
	at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:357)
	at org.hibernate.loader.Loader.doList(Loader.java:2868)
	at org.hibernate.loader.Loader.doList(Loader.java:2850)
	at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2682)
	at org.hibernate.loader.Loader.list(Loader.java:2677)
	at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:540)
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:400)
	at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:218)
	at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1459)
	at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1649)
	at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1617)
	at org.hibernate.query.internal.AbstractProducedQuery.getSingleResult(AbstractProducedQuery.java:1665)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.getSingleResult(CriteriaQueryTypeQueryAdapter.java:111)
	at jdk.internal.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:410)
	at com.sun.proxy.$Proxy324.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:198)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 42 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column apiusagest0_.tbel_exec does not exist
  Hint: Perhaps you meant to reference the column "apiusagest0_.re_exec".
  Position: 396
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:57)
	... 80 common frames omitted
2024-01-25 17:38:26,119 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:38:29,120 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:38:32,120 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:38:35,120 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:38:38,121 [tenant-dispatcher-1-1] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
2024-01-25 17:38:38,803 [TB-Scheduling-6] INFO  o.t.s.c.t.s.DefaultTransportService - Transport Stats: openConnections [0]
2024-01-25 17:38:38,868 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - Total timing statistics below:
2024-01-25 17:38:38,870 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: calls: 4, failures: 4, exec time: 12 
2024-01-25 17:38:38,870 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Top 3 methods by timing:
2024-01-25 17:38:38,871 [TB-Scheduling-2] INFO  o.t.s.dao.aspect.SqlDaoCallsAspect - [129adff0-6dfc-11ee-9984-2b8a0281ea3f]: method: JpaApiUsageStateDao.findApiUsageStateByEntityId(..), calls: 4, failures: 4, exec time: 12
2024-01-25 17:38:41,121 [tenant-dispatcher-0-2] INFO  o.t.server.actors.tenant.TenantActor - [129adff0-6dfc-11ee-9984-2b8a0281ea3f] Processing missing Tenant msg: org.thingsboard.server.actors.device.SessionTimeoutCheckMsg@10852183
